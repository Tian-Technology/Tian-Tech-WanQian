<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>WanQianCora</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* ç®€æ´çš„è±†åŒ…é£æ ¼æ ·å¼ */
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            font-size: 14px;
            line-height: 1.5;
            margin: 0;
            padding: 0;
            background: #ffffff;
            color: #1f2937;
            height: 100vh;
            width: 100vw;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        /* ç®€æ´çš„å¯¼èˆªæ  */
        .navbar {
            background: #ffffff;
            padding: 12px 0;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }
        
        .nav-logo {
            color: #1f2937;
            font-size: 1.2rem;
            font-weight: 600;
            text-decoration: none;
            font-family: 'Inter', sans-serif;
        }
        
        .nav-menu {
            display: flex;
            list-style: none;
            margin: 0;
            padding: 0;
            gap: 20px;
        }
        
        .nav-menu li a {
            color: #6b7280;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s ease;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .nav-menu li a:hover {
            background: #f3f4f6;
            color: #374151;
        }
        
        /* ä¸»å†…å®¹åŒºåŸŸ */
        .main-container {
            display: flex;
            height: calc(100vh - 60px);
            position: relative;
            margin-left: 250px;
            width: calc(100% - 250px);
        }
        
        /* ä¾§æ  */
        .sidebar {
            width: 250px;
            background: #f8fafc;
            border-right: 1px solid #e2e8f0;
            position: fixed;
            left: 0;
            top: 60px;
            bottom: 0;
            overflow-y: auto;
            z-index: 100;
        }
        
        .sidebar-header {
            padding: 20px 16px;
            border-bottom: 1px solid #e2e8f0;
            background: #ffffff;
        }
        
        .sidebar-header h3 {
            margin: 0;
            font-size: 16px;
            font-weight: 600;
            color: #1f2937;
        }
        
        .sidebar-content {
            flex: 1;
            padding: 12px 0;
            overflow-y: auto;
        }
        
        .sidebar-item {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            color: #64748b;
            text-decoration: none;
            transition: all 0.2s ease;
            cursor: pointer;
            border-left: 3px solid transparent;
        }
        
        .sidebar-item:hover {
            background: #f1f5f9;
            color: #374151;
        }
        
        .sidebar-item.active {
            background: #e0f2fe;
            color: #0369a1;
            border-left-color: #0ea5e9;
        }
        
        .sidebar-icon {
            margin-right: 12px;
            font-size: 16px;
            width: 20px;
            text-align: center;
        }
        
        /* èŠå¤©å®¹å™¨ */
        .chat-container {
            background: #ffffff;
            position: relative;
            max-width: none;
            margin: 0;
            width: 100%;
            height: calc(100vh - 180px);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-sizing: border-box;
        }
        
        .chat-container::-webkit-scrollbar {
            width: 6px;
        }
        
        .chat-container::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        
        .chat-container::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 3px;
        }
        
        .chat-container::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
        
        /* å¯¹è¯è®°å½•æ ‡é¢˜ */
        .chat-header {
            padding: 16px 20px;
            background: #f8fafc;
            border-bottom: 1px solid #e2e8f0;
            font-size: 14px;
            font-weight: 600;
            color: #475569;
        }
        
        /* æ¶ˆæ¯æ ·å¼ */
        #chat-history {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            min-height: 0;
            height: 100%;
        }
        
        .message {
            margin-bottom: 20px;
            padding: 16px 20px;
            border-radius: 12px;
            word-wrap: break-word;
        }
        
        /* æ•°å­¦å…¬å¼æ ·å¼ */
        .math-inline {
            font-family: 'Cambria Math', 'STIX Two Text', 'Times New Roman', serif !important;
            font-style: italic !important;
            background: #f8fafc !important;
            padding: 2px 6px !important;
            border-radius: 4px !important;
            border: 1px solid #e2e8f0 !important;
            font-size: 14px !important;
            line-height: 1.4 !important;
            display: inline-block !important;
            vertical-align: middle !important;
        }
        
        .math-block {
            font-family: 'Cambria Math', 'STIX Two Text', 'Times New Roman', serif !important;
            font-style: italic !important;
            background: #f8fafc !important;
            padding: 16px !important;
            border-radius: 8px !important;
            border: 1px solid #e2e8f0 !important;
            font-size: 16px !important;
            line-height: 1.6 !important;
            text-align: center !important;
            margin: 16px 0 !important;
            display: block !important;
        }
        
        /* æ•°å­¦ç¬¦å·ç‰¹æ®Šæ ·å¼ */
        .math-inline sup, .math-block sup {
            font-size: 0.8em !important;
            vertical-align: super !important;
        }
        
        .math-inline sub, .math-block sub {
            font-size: 0.8em !important;
            vertical-align: sub !important;
        }
        
        .math-inline .frac, .math-block .frac {
            display: inline-block !important;
            text-align: center !important;
            vertical-align: middle !important;
        }
        
        .math-inline .frac > span, .math-block .frac > span {
            display: block !important;
            font-size: 0.8em !important;
        }
        
        .math-inline .frac .top, .math-block .frac .top {
            border-bottom: 1px solid #374151 !important;
            padding-bottom: 1px !important;
        }
            font-size: 14px;
            line-height: 1.6;
            max-width: 85%;
            animation: fadeInUp 0.3s ease-out;
        }
        
        @keyframes fadeInUp {
            from { 
                opacity: 0; 
                transform: translateY(10px);
            }
            to { 
                opacity: 1; 
                transform: translateY(0);
            }
        }
        
        .user-message {
            background: #3b82f6;
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 4px;
        }
        
        .ai-message {
            background: #f8fafc;
            color: #1f2937;
            border: 1px solid #e2e8f0;
            border-bottom-left-radius: 4px;
        }
        
        /* è¾“å…¥åŒºåŸŸ */
        .input-container {
            background: #ffffff;
            border-top: 1px solid #e5e7eb;
            padding: 16px 16px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            max-width: none;
            margin: 0;
            width: 100%;
            position: fixed;
            bottom: 0;
            left: 250px;
            right: 0;
            z-index: 99;
            box-sizing: border-box;
            height: auto;
            min-height: 120px;
        }
        
        .model-selector {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .model-selector label {
            font-size: 12px;
            color: #6b7280;
            font-weight: 500;
        }
        
        .model-selector select {
            padding: 6px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            background: #ffffff;
            font-size: 13px;
            color: #374151;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .model-selector select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .input-area {
            display: flex;
            gap: 12px;
            align-items: flex-end;
        }
        
        textarea {
            flex: 1;
            height: 60px;
            padding: 12px 16px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            resize: none;
            font-size: 14px;
            line-height: 1.5;
            transition: all 0.2s ease;
            background: #ffffff;
            color: #1f2937;
        }
        
        textarea:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        textarea::placeholder {
            color: #9ca3af;
        }
        
        button {
            background: #3b82f6;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            font-size: 14px;
            transition: all 0.2s ease;
            height: 44px;
            min-width: 80px;
        }
        
        button:hover {
            background: #2563eb;
        }
        
        button:active {
            transform: scale(0.98);
        }
        
        .loading {
            color: #6b7280;
            font-style: italic;
            font-size: 13px;
        }

        .loading-dots {
            display: flex;
            gap: 4px;
        }
        
        .loading-dots span {
            width: 6px;
            height: 6px;
            background: #6b7280;
            border-radius: 50%;
            animation: loading 1.4s ease-in-out infinite both;
        }
        
        .loading-dots span:nth-child(1) {
            animation-delay: -0.32s;
        }
        
        .loading-dots span:nth-child(2) {
            animation-delay: -0.16s;
        }
        
        @keyframes loading {
            0%, 80%, 100% {
                transform: scale(0);
            }
            40% {
                transform: scale(1);
            }
        }
        
        /* å¤šé¡µé¢å¸ƒå±€æ ·å¼ */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            height: 100%;
            position: relative;
        }
        
        .content-section {
            display: none;
            flex: 1;
            height: 100%;
            overflow-y: auto;
            padding: 0;
        }
        
        .content-section.active {
            display: flex;
            flex-direction: column;
        }
        
        .page-container {
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
            width: 100%;
        }
        
        .page-container h2 {
            font-size: 24px;
            margin-bottom: 20px;
            color: #1f2937;
            border-bottom: 2px solid #3b82f6;
            padding-bottom: 10px;
        }
        
        .page-container h3 {
            font-size: 18px;
            margin: 15px 0 10px 0;
            color: #374151;
        }
        
        .page-container p {
            margin: 8px 0;
            line-height: 1.6;
            color: #6b7280;
        }
        
        /* è®¾ç½®é¡µé¢æ ·å¼ */
        .settings-content {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .setting-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: #f8fafc;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
        }
        
        .setting-item label {
            font-weight: 500;
            min-width: 80px;
            color: #374151;
        }
        
        .setting-item select {
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            background: white;
            font-size: 14px;
        }
        
        /* å¸®åŠ©æ–‡æ¡£æ ·å¼ */
        .help-content {
            line-height: 1.8;
        }
        
        .help-content h3 {
            color: #3b82f6;
            margin-top: 20px;
        }
        
        /* æœç´¢é¡µé¢æ ·å¼ */
        .search-bar {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .search-bar input {
            flex: 1;
            padding: 10px 15px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .search-bar button {
            padding: 10px 20px;
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }
        
        /* å¯¹è¯å†å²æ ·å¼ */
        .history-list {
            background: #f8fafc;
            border-radius: 8px;
            padding: 20px;
            border: 1px solid #e5e7eb;
        }
        
        /* è¾“å…¥åŒºåŸŸéšè—ç±» */
        .input-container.hidden {
            display: none;
        }

        /* ç®€åŒ–çš„æ€è€ƒè¿‡ç¨‹æ ·å¼ */
        .thinking-process {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 12px;
            margin: 8px 0;
        }
        
        .thinking-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 8px;
            padding-bottom: 8px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .thinking-icon {
            font-size: 16px;
            background: #64748b;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .thinking-title {
            font-size: 14px;
            font-weight: 600;
            color: #374151;
            flex: 1;
            margin-left: 8px;
        }
        
        .thinking-model {
            font-size: 12px;
            color: #64748b;
            background: #f1f5f9;
            padding: 2px 6px;
            border-radius: 3px;
            font-weight: 500;
        }
        
        .thinking-content {
            margin-bottom: 12px;
        }
        
        .thinking-status {
            font-size: 13px;
            color: #64748b;
            margin-bottom: 6px;
            font-weight: 500;
        }
        
        .thinking-realtime {
            font-size: 13px;
            color: #374151;
            background: #ffffff;
            padding: 8px 10px;
            border-radius: 4px;
            border-left: 2px solid #64748b;
            margin-bottom: 8px;
            line-height: 1.4;
            min-height: 40px;
            max-height: 120px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .thinking-animation {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        
        .thinking-step {
            font-size: 12px;
            color: #64748b;
            padding: 4px 6px;
            background: #f8fafc;
            border-radius: 3px;
            border-left: 2px solid #94a3b8;
        }
        
        .thinking-progress {
            margin-top: 8px;
        }
        
        .progress-bar {
            width: 100%;
            height: 4px;
            background: #e2e8f0;
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 4px;
        }
        
        .progress-fill {
            height: 100%;
            background: #64748b;
            border-radius: 2px;
            width: 60%;
        }
        
        .progress-text {
            font-size: 11px;
            color: #64748b;
            text-align: center;
        }
        
        /* æŠ˜å /å±•å¼€æ ·å¼ */
        .thinking-process.completed {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 12px;
            margin: 8px 0;
        }
        
        .thinking-process.completed .thinking-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }
        
        .thinking-toggle {
            font-size: 13px;
            color: #64748b;
            font-weight: 500;
        }
        
        .thinking-process.completed .thinking-content {
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid #e2e8f0;
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            /* åŸºç¡€å¸ƒå±€è°ƒæ•´ */
            body {
                font-size: 14px;
                height: 100vh;
                overflow: hidden;
            }
            
            .main-container {
                flex-direction: column;
                height: 100vh;
                margin-left: 0;
                width: 100%;
                position: relative;
            }
            
            .sidebar {
                width: 100%;
                height: 60px;
                position: fixed;
                top: 60px;
                left: 0;
                right: 0;
                bottom: auto;
                z-index: 1000;
                border-right: none;
                border-bottom: 1px solid #e2e8f0;
                display: flex;
                flex-direction: row;
                overflow-x: auto;
                overflow-y: hidden;
                background: #ffffff;
            }
            
            .main-content {
                margin-top: 60px;
                height: calc(100vh - 60px);
                position: relative;
                overflow: hidden;
            }
            
            .chat-container {
                height: calc(100vh - 60px);
                width: 100%;
                margin-left: 0;
                position: relative;
                overflow: hidden;
            }
            
            #chat-history {
                height: 100%;
                overflow-y: auto;
                padding-bottom: 160px;
                box-sizing: border-box;
            }
            
            .sidebar-header {
                display: none;
            }
            
            .sidebar-content {
                display: flex;
                flex-direction: row;
                padding: 0;
                width: 100%;
            }
            
            .sidebar-item {
                flex: 1;
                min-width: 80px;
                padding: 8px 4px;
                border-left: none;
                border-top: 3px solid transparent;
                flex-direction: column;
                text-align: center;
                font-size: 12px;
            }
            
            .sidebar-item.active {
                border-left-color: transparent;
                border-top-color: #0ea5e9;
            }
            
            .sidebar-icon {
                margin-right: 0;
                margin-bottom: 4px;
                font-size: 14px;
            }
            
            .input-container {
                position: fixed;
                left: 0;
                right: 0;
                bottom: 0;
                padding: 12px 12px 0 12px;
                background: #ffffff;
                border-top: 1px solid #e5e7eb;
                z-index: 999;
                height: auto;
                min-height: 160px;
                box-sizing: border-box;
                width: 100%;
                margin: 0;
            }
            
            /* å¯¼èˆªæ è°ƒæ•´ */
            .navbar {
                padding: 8px 12px;
            }
            
            .nav-logo {
                font-size: 16px;
            }
            
            .nav-menu {
                display: none;
            }
            
            /* ç§»åŠ¨ç«¯æ±‰å ¡èœå• */
            .mobile-menu-btn {
                display: block;
                background: none;
                border: none;
                font-size: 20px;
                color: #374151;
                cursor: pointer;
                padding: 4px;
            }
            
            .mobile-nav-menu {
                position: fixed;
                top: 0;
                left: -100%;
                width: 80%;
                height: 100vh;
                background: #ffffff;
                z-index: 2000;
                transition: left 0.3s ease;
                box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            }
            
            .mobile-nav-menu.active {
                left: 0;
            }
            
            .mobile-nav-header {
                padding: 16px;
                border-bottom: 1px solid #e2e8f0;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }
            
            .mobile-nav-close {
                background: none;
                border: none;
                font-size: 20px;
                cursor: pointer;
                color: #64748b;
            }
            
            .mobile-nav-content {
                padding: 16px;
            }
            
            .mobile-nav-item {
                display: block;
                padding: 12px 0;
                color: #374151;
                text-decoration: none;
                border-bottom: 1px solid #f1f5f9;
            }
            
            /* æ¶ˆæ¯æ ·å¼è°ƒæ•´ */
            .message {
                max-width: 92%;
                padding: 12px 16px;
                font-size: 14px;
                line-height: 1.5;
            }
            
            #chat-history {
                padding: 16px;
            }
            
            /* è¾“å…¥åŒºåŸŸè°ƒæ•´ */
            .input-area {
                flex-direction: column;
                gap: 8px;
                height: auto;
                min-height: 100px;
                width: 100%;
            }
            
            .model-selector {
                display: flex;
                align-items: center;
                gap: 8px;
                margin-bottom: 8px;
                width: 100%;
            }
            
            .model-selector label {
                font-size: 14px;
                min-width: auto;
            }
            
            .model-selector select {
                flex: 1;
                min-width: auto;
                font-size: 14px;
                padding: 6px 8px;
                width: 100%;
            }
            
            textarea {
                height: 60px;
                font-size: 16px; /* é˜²æ­¢iOSç¼©æ”¾ */
                min-height: 60px;
                max-height: 120px;
                box-sizing: border-box;
                width: 100%;
                margin: 0;
            }
            
            button {
                width: 100%;
                height: 44px;
                font-size: 16px;
                box-sizing: border-box;
                margin: 0;
            }
            
            /* è®¾ç½®é¡µé¢è°ƒæ•´ */
            .settings-content {
                padding: 16px;
            }
            
            .setting-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
            
            .setting-item label {
                min-width: auto;
            }
            
            /* é¡µé¢å®¹å™¨è°ƒæ•´ */
            .page-container {
                padding: 16px;
            }
            
            .page-container h2 {
                font-size: 20px;
            }
            
            /* æ·±è‰²ä¸»é¢˜ç§»åŠ¨ç«¯é€‚é… */
            body.dark-theme .sidebar {
                border-top: 1px solid #334155;
            }
            
            body.dark-theme .mobile-nav-menu {
                background: #1e293b;
            }
            
            body.dark-theme .mobile-nav-header {
                border-bottom: 1px solid #334155;
            }
            
            body.dark-theme .mobile-nav-item {
                color: #e2e8f0;
                border-bottom: 1px solid #334155;
            }
        }

        /* æ·±è‰²ä¸»é¢˜æ ·å¼ */
        body.dark-theme {
            background: #0f172a;
            color: #e2e8f0;
        }
        
        body.dark-theme .navbar {
            background: #1e293b;
            border-bottom: 1px solid #334155;
        }
        
        body.dark-theme .nav-logo {
            color: #e2e8f0;
        }
        
        body.dark-theme .nav-menu li a {
            color: #94a3b8;
        }
        
        body.dark-theme .nav-menu li a:hover {
            background: #334155;
            color: #e2e8f0;
        }
        
        body.dark-theme .sidebar {
            background: #1e293b;
            border-right: 1px solid #334155;
        }
        
        body.dark-theme .sidebar-header {
            background: #1e293b;
            border-bottom: 1px solid #334155;
        }
        
        body.dark-theme .sidebar-header h3 {
            color: #e2e8f0;
        }
        
        body.dark-theme .sidebar-item {
            color: #94a3b8;
        }
        
        body.dark-theme .sidebar-item:hover {
            background: #334155;
            color: #e2e8f0;
        }
        
        body.dark-theme .sidebar-item.active {
            background: #334155;
            color: #60a5fa;
            border-left-color: #60a5fa;
        }
        
        body.dark-theme .chat-container {
            background: #0f172a;
        }
        
        body.dark-theme .chat-header {
            background: #1e293b;
            border-bottom: 1px solid #334155;
            color: #94a3b8;
        }
        
        body.dark-theme #chat-history {
            background: #0f172a;
        }
        
        body.dark-theme .ai-message {
            background: #1e293b;
            color: #e2e8f0;
            border: 1px solid #334155;
        }
        
        body.dark-theme .user-message {
            background: #3b82f6;
            color: white;
        }
        
        body.dark-theme .input-container {
            background: #1e293b;
            border-top: 1px solid #334155;
        }
        
        body.dark-theme textarea {
            background: #334155;
            color: #e2e8f0;
            border: 1px solid #475569;
        }
        
        body.dark-theme textarea:focus {
            border-color: #60a5fa;
            box-shadow: 0 0 0 3px rgba(96, 165, 250, 0.1);
        }
        
        body.dark-theme textarea::placeholder {
            color: #64748b;
        }
        
        body.dark-theme .model-selector label {
            color: #94a3b8;
        }
        
        body.dark-theme .model-selector select {
            background: #334155;
            color: #e2e8f0;
            border: 1px solid #475569;
        }
        
        body.dark-theme .page-container {
            background: #0f172a;
        }
        
        body.dark-theme .page-container h2 {
            color: #e2e8f0;
            border-bottom: 2px solid #60a5fa;
        }
        
        body.dark-theme .page-container h3 {
            color: #cbd5e1;
        }
        
        body.dark-theme .page-container p {
            color: #94a3b8;
        }
        
        body.dark-theme .settings-content {
            background: #0f172a;
        }
        
        body.dark-theme .setting-item {
            background: #1e293b;
            border: 1px solid #334155;
        }
        
        body.dark-theme .setting-item label {
            color: #e2e8f0;
        }
        
        body.dark-theme .setting-item select {
            background: #334155;
            color: #e2e8f0;
            border: 1px solid #475569;
        }
        
        body.dark-theme .setting-item input {
            background: #334155;
            color: #e2e8f0;
            border: 1px solid #475569;
        }
        
        body.dark-theme .setting-item button {
            background: #3b82f6;
            color: white;
        }
        
        /* å­—ä½“å¤§å°æ ·å¼ */
        body.font-small {
            font-size: 12px;
        }
        
        body.font-medium {
            font-size: 14px;
        }
        
        body.font-large {
            font-size: 16px;
        }
        
        /* æ¶ˆæ¯åŠ¨ç”»ç¦ç”¨æ ·å¼ */
        .no-animation .message {
            animation: none !important;
        }
        
        /* æ€è€ƒè¿‡ç¨‹éšè—æ ·å¼ */
        .hide-thinking .thinking-process {
            display: none !important;
        }
        
        body.dark-theme .history-list {
            background: #1e293b;
            border: 1px solid #334155;
        }
        
        body.dark-theme .thinking-process {
            background: #1e293b;
            border: 1px solid #334155;
        }
        
        body.dark-theme .thinking-header {
            border-bottom: 1px solid #334155;
        }
        
        body.dark-theme .thinking-title {
            color: #e2e8f0;
        }
        
        body.dark-theme .thinking-model {
            background: #334155;
            color: #94a3b8;
        }
        
        body.dark-theme .thinking-status {
            color: #94a3b8;
        }
        
        body.dark-theme .thinking-realtime {
            background: #0f172a;
            color: #e2e8f0;
            border-left: 2px solid #64748b;
        }
        
        body.dark-theme .thinking-step {
            color: #94a3b8;
            background: #1e293b;
            border-left: 2px solid #475569;
        }
        
        body.dark-theme .progress-bar {
            background: #334155;
        }
        
        body.dark-theme .progress-fill {
            background: #60a5fa;
        }
        
        body.dark-theme .progress-text {
            color: #94a3b8;
        }
        
        body.dark-theme .thinking-original {
            background: #1e293b;
            border: 1px solid #334155;
        }
        
        body.dark-theme .thinking-final {
            color: #e2e8f0;
        }
        
        body.dark-theme .final-answer {
            color: #e2e8f0;
        }


            
            /* æ·±è‰²ä¸»é¢˜ç§»åŠ¨ç«¯é€‚é… */
            body.dark-theme .sidebar {
                border-top: 1px solid #334155;
            }
            
            body.dark-theme .mobile-nav-menu {
                background: #1e293b;
            }
            
            body.dark-theme .mobile-nav-header {
                border-bottom: 1px solid #334155;
            }
            
            body.dark-theme .mobile-nav-item {
                color: #e2e8f0;
                border-bottom: 1px solid #334155;
            }
        }
        
        @media (max-width: 480px) {
            .sidebar-item {
                min-width: 70px;
                font-size: 11px;
                padding: 6px 2px;
            }
            
            .sidebar-icon {
                font-size: 12px;
            }
            
            .message {
                max-width: 95%;
                padding: 10px 12px;
            }
            
            #chat-history {
                padding: 12px;
            }
            
            .input-container {
                padding: 8px;
            }
            
            .settings-content {
                padding: 12px;
            }
            
            .page-container {
                padding: 12px;
            }
            
            .nav-logo {
                font-size: 14px;
            }
            
            .mobile-menu-btn {
                font-size: 18px;
            }
            
            textarea {
                height: 45px;
                font-size: 16px;
            }
            
            button {
                height: 40px;
                font-size: 15px;
            }
        }
        
        /* ç§»åŠ¨ç«¯èœå•æŒ‰é’®æ ·å¼ */
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            font-size: 20px;
            color: #374151;
            cursor: pointer;
            padding: 8px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        
        .mobile-menu-btn:hover {
            background-color: #f3f4f6;
        }
        
        body.dark-theme .mobile-menu-btn {
            color: #e5e7eb;
        }
        
        body.dark-theme .mobile-menu-btn:hover {
            background-color: #374151;
        }
        
        /* ç§»åŠ¨ç«¯å¯¼èˆªèœå•æ ·å¼ */
        .mobile-nav-menu {
            position: fixed;
            top: 0;
            left: -100%;
            width: 280px;
            height: 100%;
            background: white;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            transition: left 0.3s ease;
            z-index: 1000;
            display: flex;
            flex-direction: column;
        }
        
        .mobile-nav-menu.active {
            left: 0;
        }
        
        .mobile-nav-header {
            padding: 16px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #f8fafc;
        }
        
        .mobile-nav-header span {
            font-weight: 600;
            color: #374151;
        }
        
        .mobile-nav-close {
            background: none;
            border: none;
            font-size: 24px;
            color: #6b7280;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        
        .mobile-nav-close:hover {
            background-color: #f3f4f6;
        }
        
        .mobile-nav-content {
            flex: 1;
            padding: 8px 0;
            overflow-y: auto;
        }
        
        .mobile-nav-item {
            display: block;
            padding: 12px 16px;
            color: #374151;
            text-decoration: none;
            border-bottom: 1px solid #f3f4f6;
            transition: background-color 0.2s;
        }
        
        .mobile-nav-item:hover {
            background-color: #f8fafc;
        }
        
        body.dark-theme .mobile-nav-menu {
            background: #1e293b;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.3);
        }
        
        body.dark-theme .mobile-nav-header {
            border-bottom: 1px solid #334155;
            background: #0f172a;
        }
        
        body.dark-theme .mobile-nav-header span {
            color: #e2e8f0;
        }
        
        body.dark-theme .mobile-nav-close {
            color: #94a3b8;
        }
        
        body.dark-theme .mobile-nav-close:hover {
            background-color: #334155;
        }
        
        body.dark-theme .mobile-nav-item {
            color: #e2e8f0;
            border-bottom: 1px solid #334155;
        }
        
        body.dark-theme .mobile-nav-item:hover {
            background-color: #334155;
        }

    </style>
</head>
<body>
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="#" class="nav-logo">WanQianCora</a>
            <button class="mobile-menu-btn" onclick="toggleMobileMenu()">â˜°</button>
            <ul class="nav-menu">
                <li><a href="WanQian/index.html">é¦–é¡µ</a></li>
                <li><a href="/index.html">TianTeché¦–é¡µ</a></li>
                <li><a href="WanQian/WanQiandoc.html">ç‰ˆæœ¬æ—¥å¿—</a></li>
                <li><a href="#" onclick="location.reload(); return false;">æ–°å¯¹è¯</a></li>
            </ul>   
        </div>
    </nav>
    
    <!-- ç§»åŠ¨ç«¯å¯¼èˆªèœå• -->
    <div class="mobile-nav-menu" id="mobile-nav-menu">
        <div class="mobile-nav-header">
            <span>èœå•</span>
            <button class="mobile-nav-close" onclick="toggleMobileMenu()">Ã—</button>
        </div>
        <div class="mobile-nav-content">
            <a href="index.html" class="mobile-nav-item">é¦–é¡µ</a>
            <a href="/index.html" class="mobile-nav-item">TianTeché¦–é¡µ</a>
            <a href="WanQiandoc.html" class="mobile-nav-item">ç‰ˆæœ¬æ—¥å¿—</a>
            <a href="#" class="mobile-nav-item" onclick="location.reload(); toggleMobileMenu(); return false;">æ–°å¯¹è¯</a>
        </div>
    </div>

    <!-- ä¸»å†…å®¹åŒºåŸŸ -->
    <div class="main-container">
        <!-- ä¾§æ  -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h3>åŠŸèƒ½èœå•</h3>
            </div>
            <div class="sidebar-content">
                <div class="sidebar-item active">
                    <span class="sidebar-icon">ğŸ’¬</span>
                    <span>å½“å‰å¯¹è¯</span>
                </div>
                <div class="sidebar-item">
                    <span class="sidebar-icon">ğŸ“</span>
                    <span>å¯¹è¯å†å²</span>
                </div>
                <div class="sidebar-item">
                    <span class="sidebar-icon">âš™ï¸</span>
                    <span>è®¾ç½®</span>
                </div>
                <div class="sidebar-item">
                    <span class="sidebar-icon">ğŸ“š</span>
                    <span>å¸®åŠ©æ–‡æ¡£</span>
                </div>
                <div class="sidebar-item">
                    <span class="sidebar-icon">ğŸ”</span>
                    <span>æœç´¢</span>
                </div>
            </div>
        </div>
        
        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <div class="main-content">
            <!-- å½“å‰å¯¹è¯é¡µé¢ -->
            <div id="current-chat" class="content-section active">
                <div class="chat-container">
                    <div class="chat-header">å¯¹è¯è®°å½•</div>
                    <div id="chat-history"></div>
                </div>
            </div>
            
            <!-- å¯¹è¯å†å²é¡µé¢ -->
            <div id="chat-history-page" class="content-section">
                <div class="page-container">
                    <h2>å¯¹è¯å†å²</h2>
                    <div class="history-list">
                        <p>å¯¹è¯å†å²åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­...</p>
                    </div>
                </div>
            </div>
            
            <!-- è®¾ç½®é¡µé¢ -->
            <div id="settings-page" class="content-section">
                <div class="page-container">
                    <h2>è®¾ç½®</h2>
                    <div class="settings-content">
                        <div class="setting-item">
                            <label>æ¨¡å‹é€‰æ‹©ï¼š</label>
                            <select id="settings-model-select">
                                <option value="glm-z1-flash">WanQianCora Ultra</option>
                                <option value="glm-z1-flash">WanQianCora</option>
                                <option value="glm-4.5-flash">WanQianCora Pro</option>
                                <option value="glm-4v-flash">WanQianCora Intelligent</option>
                                <option value="glm-4-flash-250414">WanQianCora mini</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label>ä¸»é¢˜ï¼š</label>
                            <select id="theme-select">
                                <option value="light">æµ…è‰²ä¸»é¢˜</option>
                                <option value="dark">æ·±è‰²ä¸»é¢˜</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label>å­—ä½“å¤§å°ï¼š</label>
                            <select id="font-size-select">
                                <option value="small">å°</option>
                                <option value="medium" selected>ä¸­</option>
                                <option value="large">å¤§</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label>è‡ªåŠ¨ä¿å­˜ï¼š</label>
                            <select id="auto-save-select">
                                <option value="enabled">å¯ç”¨</option>
                                <option value="disabled">ç¦ç”¨</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label>æ˜¾ç¤ºæ€è€ƒè¿‡ç¨‹ï¼š</label>
                            <select id="show-thinking-select">
                                <option value="enabled">æ˜¾ç¤º</option>
                                <option value="disabled">éšè—</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label>æ¶ˆæ¯åŠ¨ç”»ï¼š</label>
                            <select id="message-animation-select">
                                <option value="enabled">å¯ç”¨</option>
                                <option value="disabled">ç¦ç”¨</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label>APIå¯†é’¥ï¼š</label>
                            <input type="password" id="api-key-input" placeholder="è¾“å…¥APIå¯†é’¥" style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px; width: 200px;">
                        </div>
                        <div class="setting-item">
                            <label>APIç«¯ç‚¹ï¼š</label>
                            <input type="text" id="api-endpoint-input" placeholder="https://api.example.com" style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px; width: 200px;">
                        </div>
                        <div class="setting-item">
                            <label>æœ€å¤§ä¸Šä¸‹æ–‡é•¿åº¦ï¼š</label>
                            <input type="number" id="max-context-input" value="4000" min="1000" max="16000" style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px; width: 100px;">
                        </div>
                        <div class="setting-item">
                            <label>æ¸©åº¦è®¾ç½®ï¼š</label>
                            <input type="range" id="temperature-slider" min="0" max="1" step="0.1" value="0.7" style="width: 150px;">
                            <span id="temperature-value">0.7</span>
                        </div>
                        <div class="setting-item">
                            <button onclick="exportSettings()" style="background: #10b981; margin-right: 10px;">å¯¼å‡ºè®¾ç½®</button>
                            <button onclick="importSettings()" style="background: #3b82f6;">å¯¼å…¥è®¾ç½®</button>
                            <button onclick="resetSettings()" style="background: #ef4444; margin-left: 10px;">é‡ç½®è®¾ç½®</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- å¸®åŠ©æ–‡æ¡£é¡µé¢ -->
            <div id="help-page" class="content-section">
                <div class="page-container">
                    <h2>å¸®åŠ©æ–‡æ¡£</h2>
                    <div class="help-content">
                        <h3>ä½¿ç”¨è¯´æ˜</h3>
                        <p>1. åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥æ‚¨çš„é—®é¢˜</p>
                        <p>2. ç‚¹å‡»å‘é€æŒ‰é’®æˆ–æŒ‰Enteré”®å‘é€æ¶ˆæ¯</p>
                        <p>3. æ¨¡å‹ä¼šæ˜¾ç¤ºæ€è€ƒè¿‡ç¨‹å¹¶æä¾›æœ€ç»ˆç­”æ¡ˆ</p>
                        <h3>åŠŸèƒ½è¯´æ˜</h3>
                        <p>â€¢ æ”¯æŒå¤šè½®å¯¹è¯</p>
                        <p>â€¢ æ˜¾ç¤ºè¯¦ç»†çš„æ€è€ƒè¿‡ç¨‹</p>
                        <p>â€¢ æ”¯æŒä»£ç å¤åˆ¶åŠŸèƒ½</p>
                    </div>
                </div>
            </div>
            
            <!-- æœç´¢é¡µé¢ -->
            <div id="search-page" class="content-section">
                <div class="page-container">
                    <h2>æœç´¢</h2>
                    <div class="search-content">
                        <div class="search-bar">
                            <input type="text" placeholder="æœç´¢å¯¹è¯å†…å®¹..." id="search-input">
                            <button onclick="performSearch()">æœç´¢</button>
                        </div>
                        <div class="search-results">
                            <p>æœç´¢åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- è¾“å…¥åŒºåŸŸ -->
        <div class="input-container">
            <div class="model-selector">
                <label for="model-select">æ¨¡å‹ï¼š</label>
                <select id="model-select">
                    <option value="glm-z1-flash">WanQianCora Ultra</option>
                    <option value="glm-z1-flash">WanQianCora</option>
                    <option value="glm-4.5-flash">WanQianCora Pro</option>
                    <option value="glm-4v-flash">WanQianCora Intelligent</option>
                    <option value="glm-4-flash-250414">WanQianCora mini</option>
                </select>
            </div>
            <div class="input-area">
                <textarea id="user-input" placeholder="è¯·è¾“å…¥æ‚¨è¦å‘é€ç»™WanQianCoraå¤§æ¨¡å‹çš„æ¶ˆæ¯..."></textarea>
                <button onclick="sendMessage()">å‘é€</button>
            </div>
        </div>
    </div>

    <script>
        // å¢å¼ºçš„Markdownè§£æå‡½æ•°
        function parseMarkdown(text) {
            if (!text) return '';
            
            // ä¿å­˜åŸå§‹æ–‡æœ¬ç”¨äºä»£ç å—å¤„ç†
            let result = text;
            
            // 1. å…ˆå¤„ç†æ•°å­¦å…¬å¼å—ï¼ˆé¿å…è¢«å…¶ä»–è§„åˆ™è¯¯å¤„ç†ï¼‰
            const mathBlocks = [];
            result = result.replace(/\$\$([\s\S]*?)\$\$/g, function(match, mathContent) {
                const mathId = 'math-block-' + mathBlocks.length;
                mathBlocks.push({
                    id: mathId,
                    content: mathContent.trim(),
                    type: 'block'
                });
                return `{{${mathId}}}`;
            });
            
            // 2. å¤„ç†è¡Œå†…æ•°å­¦å…¬å¼
            const inlineMaths = [];
            result = result.replace(/\$([^$\n]+?)\$/g, function(match, mathContent) {
                const mathId = 'inline-math-' + inlineMaths.length;
                inlineMaths.push({
                    id: mathId,
                    content: mathContent.trim(),
                    type: 'inline'
                });
                return `{{${mathId}}}`;
            });
            
            // 3. å¤„ç†ä»£ç å—ï¼ˆé¿å…ä»£ç å—å†…çš„å†…å®¹è¢«å…¶ä»–è§„åˆ™è¯¯å¤„ç†ï¼‰
            const codeBlocks = [];
            result = result.replace(/```([\s\S]*?)```/g, function(match, codeContent) {
                const blockId = 'code-block-' + codeBlocks.length;
                codeBlocks.push({
                    id: blockId,
                    content: codeContent,
                    language: codeContent.split('\n')[0].trim() || 'text'
                });
                return `{{${blockId}}}`;
            });
            
            // 4. å¤„ç†è¡Œå†…ä»£ç 
            const inlineCodes = [];
            result = result.replace(/`([^`]+)`/g, function(match, codeContent) {
                const codeId = 'inline-code-' + inlineCodes.length;
                inlineCodes.push({
                    id: codeId,
                    content: codeContent
                });
                return `{{${codeId}}}`;
            });
            
            // 3. å¤„ç†æ ‡é¢˜ï¼ˆæ”¯æŒATXé£æ ¼å’ŒSetexté£æ ¼ï¼‰
            result = result.replace(/^###### (.+)$/gm, '<h6 style="margin: 12px 0 8px 0; font-size: 14px; font-weight: 600; color: #374151;">$1</h6>');
            result = result.replace(/^##### (.+)$/gm, '<h5 style="margin: 14px 0 10px 0; font-size: 15px; font-weight: 600; color: #374151;">$1</h5>');
            result = result.replace(/^#### (.+)$/gm, '<h4 style="margin: 16px 0 12px 0; font-size: 16px; font-weight: 600; color: #374151;">$1</h4>');
            result = result.replace(/^### (.+)$/gm, '<h3 style="margin: 18px 0 14px 0; font-size: 17px; font-weight: 600; color: #1f2937;">$1</h3>');
            result = result.replace(/^## (.+)$/gm, '<h2 style="margin: 20px 0 16px 0; font-size: 18px; font-weight: 600; color: #1f2937;">$1</h2>');
            result = result.replace(/^# (.+)$/gm, '<h1 style="margin: 24px 0 18px 0; font-size: 20px; font-weight: 700; color: #1f2937;">$1</h1>');
            
            // 4. å¤„ç†ç²—ä½“å’Œæ–œä½“ï¼ˆæ”¯æŒåµŒå¥—ï¼‰
            result = result.replace(/\*\*\*(.*?)\*\*\*/g, '<strong><em>$1</em></strong>');
            result = result.replace(/\*\*(.*?)\*\*/g, '<strong style="font-weight: 600;">$1</strong>');
            result = result.replace(/\*(.*?)\*/g, '<em style="font-style: italic;">$1</em>');
            result = result.replace(/__(.*?)__/g, '<strong style="font-weight: 600;">$1</strong>');
            result = result.replace(/_(.*?)_/g, '<em style="font-style: italic;">$1</em>');
            
            // 5. å¤„ç†åˆ é™¤çº¿
            result = result.replace(/~~(.*?)~~/g, '<del style="text-decoration: line-through; color: #6b7280;">$1</del>');
            
            // 6. å¤„ç†å¼•ç”¨ï¼ˆæ”¯æŒå¤šè¡Œå’ŒåµŒå¥—ï¼‰
            result = result.replace(/^> (.+)$/gm, '<blockquote style="border-left: 4px solid #3b82f6; margin: 12px 0; padding: 8px 16px; background: #f8fafc; border-radius: 4px; color: #4b5563;">$1</blockquote>');
            
            // 7. å¤„ç†æ— åºåˆ—è¡¨ï¼ˆæ”¯æŒå¤šç§æ ‡è®°ï¼‰
            result = result.replace(/^(\*|\-|\+) (.+)$/gm, '<li style="margin: 4px 0; line-height: 1.5;">$2</li>');
            result = result.replace(/(<li style="margin: 4px 0; line-height: 1.5;">.+<\/li>\s*)+/g, function(match) {
                return '<ul style="margin: 12px 0; padding-left: 24px; line-height: 1.5; list-style-type: disc;">' + match + '</ul>';
            });
            
            // 8. å¤„ç†æœ‰åºåˆ—è¡¨
            result = result.replace(/^(\d+)\. (.+)$/gm, '<li style="margin: 4px 0; line-height: 1.5;">$2</li>');
            result = result.replace(/(<li style="margin: 4px 0; line-height: 1.5;">.+<\/li>\s*)+/g, function(match) {
                return '<ol style="margin: 12px 0; padding-left: 24px; line-height: 1.5;">' + match + '</ol>';
            });
            
            // 9. å¤„ç†ä»»åŠ¡åˆ—è¡¨
            result = result.replace(/^- \[ \] (.+)$/gm, '<li style="margin: 4px 0; line-height: 1.5;"><input type="checkbox" disabled> $1</li>');
            result = result.replace(/^- \[x\] (.+)$/gm, '<li style="margin: 4px 0; line-height: 1.5;"><input type="checkbox" checked disabled> $1</li>');
            
            // 10. å¤„ç†è¡¨æ ¼ï¼ˆåŸºç¡€æ”¯æŒï¼‰
            result = result.replace(/\|(.+)\|\n\|[-:]+\|\n((?:\|.+\|\n)*)/g, function(match, header, rows) {
                const headers = header.split('|').filter(h => h.trim()).map(h => `<th style="padding: 8px 12px; border: 1px solid #e2e8f0; background: #f8fafc; font-weight: 600;">${h.trim()}</th>`).join('');
                const rowLines = rows.split('\n').filter(r => r.trim()).map(row => {
                    const cells = row.split('|').filter(c => c.trim()).map(c => `<td style="padding: 8px 12px; border: 1px solid #e2e8f0;">${c.trim()}</td>`).join('');
                    return `<tr>${cells}</tr>`;
                }).join('');
                return `<table style="border-collapse: collapse; margin: 12px 0; width: 100%; border: 1px solid #e2e8f0;"><thead><tr>${headers}</tr></thead><tbody>${rowLines}</tbody></table>`;
            });
            
            // 11. å¤„ç†é“¾æ¥
            result = result.replace(/\[(.*?)\]\((.*?)\)/g, '<a href="$2" target="_blank" rel="noopener noreferrer" style="color: #3b82f6; text-decoration: none; border-bottom: 1px solid #3b82f6;">$1</a>');
            
            // 12. å¤„ç†å›¾ç‰‡
            result = result.replace(/!\[(.*?)\]\((.*?)\)/g, '<div style="margin: 12px 0;"><img src="$2" alt="$1" style="max-width: 100%; height: auto; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);"></div>');
            
            // 13. å¤„ç†æ°´å¹³åˆ†å‰²çº¿
            result = result.replace(/^\s*([-*_]){3,}\s*$/gm, '<hr style="border: none; height: 1px; background: #e2e8f0; margin: 20px 0;">');
            
            // 14. å¤„ç†æ¢è¡Œï¼ˆä¸¤ä¸ªç©ºæ ¼æˆ–åæ–œæ æ¢è¡Œï¼‰
            result = result.replace(/  \n/g, '<br>');
            result = result.replace(/\\\n/g, '<br>');
            
            // 15. æ¢å¤è¡Œå†…æ•°å­¦å…¬å¼ï¼ˆå¢å¼ºç‰ˆï¼‰
            inlineMaths.forEach(math => {
                let processedMath = math.content;
                
                // å¤„ç†å¸¸è§çš„æ•°å­¦ç¬¦å·
                processedMath = processedMath
                    .replace(/\\alpha/g, 'Î±')
                    .replace(/\\beta/g, 'Î²')
                    .replace(/\\gamma/g, 'Î³')
                    .replace(/\\delta/g, 'Î´')
                    .replace(/\\epsilon/g, 'Îµ')
                    .replace(/\\zeta/g, 'Î¶')
                    .replace(/\\eta/g, 'Î·')
                    .replace(/\\theta/g, 'Î¸')
                    .replace(/\\iota/g, 'Î¹')
                    .replace(/\\kappa/g, 'Îº')
                    .replace(/\\lambda/g, 'Î»')
                    .replace(/\\mu/g, 'Î¼')
                    .replace(/\\nu/g, 'Î½')
                    .replace(/\\xi/g, 'Î¾')
                    .replace(/\\pi/g, 'Ï€')
                    .replace(/\\rho/g, 'Ï')
                    .replace(/\\sigma/g, 'Ïƒ')
                    .replace(/\\tau/g, 'Ï„')
                    .replace(/\\upsilon/g, 'Ï…')
                    .replace(/\\phi/g, 'Ï†')
                    .replace(/\\chi/g, 'Ï‡')
                    .replace(/\\psi/g, 'Ïˆ')
                    .replace(/\\omega/g, 'Ï‰')
                    .replace(/\\infty/g, 'âˆ')
                    .replace(/\\sum/g, 'âˆ‘')
                    .replace(/\\prod/g, 'âˆ')
                    .replace(/\\int/g, 'âˆ«')
                    .replace(/\\partial/g, 'âˆ‚')
                    .replace(/\\nabla/g, 'âˆ‡')
                    .replace(/\\times/g, 'Ã—')
                    .replace(/\\div/g, 'Ã·')
                    .replace(/\\pm/g, 'Â±')
                    .replace(/\\mp/g, 'âˆ“')
                    .replace(/\\cdot/g, 'Â·')
                    .replace(/\\leq/g, 'â‰¤')
                    .replace(/\\geq/g, 'â‰¥')
                    .replace(/\\neq/g, 'â‰ ')
                    .replace(/\\approx/g, 'â‰ˆ')
                    .replace(/\\equiv/g, 'â‰¡')
                    .replace(/\\in/g, 'âˆˆ')
                    .replace(/\\notin/g, 'âˆ‰')
                    .replace(/\\subset/g, 'âŠ‚')
                    .replace(/\\supset/g, 'âŠƒ')
                    .replace(/\\cup/g, 'âˆª')
                    .replace(/\\cap/g, 'âˆ©')
                    .replace(/\\forall/g, 'âˆ€')
                    .replace(/\\exists/g, 'âˆƒ')
                    .replace(/\\sqrt/g, 'âˆš')
                    .replace(/\\frac\s*{(.*?)}\s*{(.*?)}/g, '<span class="frac"><span class="top">$1</span><span class="bottom">$2</span></span>')
                    .replace(/\\text\s*{(.*?)}/g, '$1');
                
                result = result.replace(
                    `{{${math.id}}}`,
                    `<span class="math-inline">${processedMath}</span>`
                );
            });
            
            // 16. æ¢å¤æ•°å­¦å…¬å¼å—ï¼ˆå¢å¼ºç‰ˆï¼‰
            mathBlocks.forEach(math => {
                let processedMath = math.content;
                
                // å¤„ç†å¸¸è§çš„æ•°å­¦ç¬¦å·
                processedMath = processedMath
                    .replace(/\\alpha/g, 'Î±')
                    .replace(/\\beta/g, 'Î²')
                    .replace(/\\gamma/g, 'Î³')
                    .replace(/\\delta/g, 'Î´')
                    .replace(/\\epsilon/g, 'Îµ')
                    .replace(/\\zeta/g, 'Î¶')
                    .replace(/\\eta/g, 'Î·')
                    .replace(/\\theta/g, 'Î¸')
                    .replace(/\\iota/g, 'Î¹')
                    .replace(/\\kappa/g, 'Îº')
                    .replace(/\\lambda/g, 'Î»')
                    .replace(/\\mu/g, 'Î¼')
                    .replace(/\\nu/g, 'Î½')
                    .replace(/\\xi/g, 'Î¾')
                    .replace(/\\pi/g, 'Ï€')
                    .replace(/\\rho/g, 'Ï')
                    .replace(/\\sigma/g, 'Ïƒ')
                    .replace(/\\tau/g, 'Ï„')
                    .replace(/\\upsilon/g, 'Ï…')
                    .replace(/\\phi/g, 'Ï†')
                    .replace(/\\chi/g, 'Ï‡')
                    .replace(/\\psi/g, 'Ïˆ')
                    .replace(/\\omega/g, 'Ï‰')
                    .replace(/\\infty/g, 'âˆ')
                    .replace(/\\sum/g, 'âˆ‘')
                    .replace(/\\prod/g, 'âˆ')
                    .replace(/\\int/g, 'âˆ«')
                    .replace(/\\partial/g, 'âˆ‚')
                    .replace(/\\nabla/g, 'âˆ‡')
                    .replace(/\\times/g, 'Ã—')
                    .replace(/\\div/g, 'Ã·')
                    .replace(/\\pm/g, 'Â±')
                    .replace(/\\mp/g, 'âˆ“')
                    .replace(/\\cdot/g, 'Â·')
                    .replace(/\\leq/g, 'â‰¤')
                    .replace(/\\geq/g, 'â‰¥')
                    .replace(/\\neq/g, 'â‰ ')
                    .replace(/\\approx/g, 'â‰ˆ')
                    .replace(/\\equiv/g, 'â‰¡')
                    .replace(/\\in/g, 'âˆˆ')
                    .replace(/\\notin/g, 'âˆ‰')
                    .replace(/\\subset/g, 'âŠ‚')
                    .replace(/\\supset/g, 'âŠƒ')
                    .replace(/\\cup/g, 'âˆª')
                    .replace(/\\cap/g, 'âˆ©')
                    .replace(/\\forall/g, 'âˆ€')
                    .replace(/\\exists/g, 'âˆƒ')
                    .replace(/\\sqrt/g, 'âˆš')
                    .replace(/\\frac\s*{(.*?)}\s*{(.*?)}/g, '<span class="frac"><span class="top">$1</span><span class="bottom">$2</span></span>')
                    .replace(/\\text\s*{(.*?)}/g, '$1');
                
                result = result.replace(
                    `{{${math.id}}}`,
                    `<div class="math-block">${processedMath}</div>`
                );
            });
            
            // 17. æ¢å¤è¡Œå†…ä»£ç 
            inlineCodes.forEach(code => {
                result = result.replace(
                    `{{${code.id}}}`,
                    `<code style="background: #f1f5f9; padding: 2px 6px; border-radius: 4px; border: 1px solid #e2e8f0; font-family: 'Courier New', monospace; font-size: 13px; color: #374151;">${code.content}</code>`
                );
            });
            
            // 18. æ¢å¤ä»£ç å—
            codeBlocks.forEach(block => {
                const escapedContent = block.content
                    .replace(/&/g, '&amp;')
                    .replace(/</g, '&lt;')
                    .replace(/>/g, '&gt;')
                    .replace(/"/g, '&quot;')
                    .replace(/'/g, '&#039;');
                
                result = result.replace(
                    `{{${block.id}}}`,
                    `<div style="position: relative; margin: 16px 0; border-radius: 8px; overflow: hidden;">
                        <div style="background: #1f2937; color: #f8fafc; padding: 8px 12px; font-size: 12px; font-weight: 500; display: flex; justify-content: space-between; align-items: center;">
                            <span>${block.language}</span>
                            <button style="background: #3b82f6; color: white; border: none; border-radius: 4px; padding: 4px 8px; font-size: 11px; cursor: pointer;" onclick="copyCodeBlock(this)">å¤åˆ¶ä»£ç </button>
                        </div>
                        <pre style="background: #0f172a; color: #e2e8f0; padding: 16px; margin: 0; overflow-x: auto; font-family: 'Courier New', monospace; font-size: 13px; line-height: 1.4;"><code>${escapedContent}</code></pre>
                    </div>`
                );
            });
            
            // 19. å¤„ç†æ®µè½ï¼ˆå°†è¿ç»­æ–‡æœ¬åŒ…è£…æˆæ®µè½ï¼‰
            const lines = result.split('\n');
            let processedLines = [];
            let currentParagraph = [];
            
            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                
                if (!line) {
                    // ç©ºè¡Œï¼Œç»“æŸå½“å‰æ®µè½
                    if (currentParagraph.length > 0) {
                        processedLines.push(`<p style="margin: 8px 0; line-height: 1.6;">${currentParagraph.join(' ')}</p>`);
                        currentParagraph = [];
                    }
                    processedLines.push('');
                } else if (line.startsWith('<') && (line.includes('h1') || line.includes('h2') || line.includes('h3') || line.includes('h4') || line.includes('h5') || line.includes('h6') || line.includes('ul') || line.includes('ol') || line.includes('blockquote') || line.includes('table') || line.includes('hr') || line.includes('div') || line.includes('span class="math-inline"'))) {
                    // å·²ç»æ˜¯HTMLæ ‡ç­¾ï¼Œç›´æ¥æ·»åŠ 
                    if (currentParagraph.length > 0) {
                        processedLines.push(`<p style="margin: 8px 0; line-height: 1.6;">${currentParagraph.join(' ')}</p>`);
                        currentParagraph = [];
                    }
                    processedLines.push(line);
                } else {
                    currentParagraph.push(line);
                }
            }
            
            // å¤„ç†æœ€åä¸€ä¸ªæ®µè½
            if (currentParagraph.length > 0) {
                processedLines.push(`<p style="margin: 8px 0; line-height: 1.6;">${currentParagraph.join(' ')}</p>`);
            }
            
            result = processedLines.join('\n');
            
            return result;
        }
        
        // å¤åˆ¶ä»£ç å—å‡½æ•°
        function copyCodeBlock(button) {
            const codeBlock = button.parentElement.nextElementSibling;
            const text = codeBlock.textContent;
            navigator.clipboard.writeText(text).then(() => {
                const originalText = button.textContent;
                button.textContent = 'å·²å¤åˆ¶';
                button.style.background = '#10b981';
                setTimeout(() => {
                    button.textContent = originalText;
                    button.style.background = '#3b82f6';
                }, 2000);
            }).catch(err => {
                console.error('å¤åˆ¶å¤±è´¥:', err);
                button.textContent = 'å¤åˆ¶å¤±è´¥';
                button.style.background = '#ef4444';
                setTimeout(() => {
                    button.textContent = 'å¤åˆ¶ä»£ç ';
                    button.style.background = '#3b82f6';
                }, 2000);
            });
        }
        
        // å¤åˆ¶è¡Œå†…ä»£ç å‡½æ•°ï¼ˆå…¼å®¹æ—§ç‰ˆæœ¬ï¼‰
        function copyCode(button) {
            const codeBlock = button.previousElementSibling;
            const text = codeBlock.textContent;
            navigator.clipboard.writeText(text).then(() => {
                const originalText = button.textContent;
                button.textContent = 'å·²å¤åˆ¶';
                button.style.background = '#10b981';
                setTimeout(() => {
                    button.textContent = originalText;
                    button.style.background = '#3b82f6';
                }, 2000);
            }).catch(err => {
                console.error('å¤åˆ¶å¤±è´¥:', err);
                button.textContent = 'å¤åˆ¶å¤±è´¥';
                button.style.background = '#ef4444';
                setTimeout(() => {
                    button.textContent = 'å¤åˆ¶';
                    button.style.background = '#3b82f6';
                }, 2000);
            });
        }
        
        // éšè—çš„APIå¯†é’¥
        const API_KEY = "74f181dfaa934ce5911ffc49ada3563b.aivDJtSXxpLDybs1";
        
        // å½“å‰å¯¹è¯çš„èŠå¤©å†å²
        let chatHistory = [];
        
        // æ·»åŠ æ¶ˆæ¯åˆ°èŠå¤©è®°å½•
        function addMessageToChat(role, content, isLoading = false, model = '') {
            const chatHistory = document.getElementById('chat-history');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${role}-message`;
            
            if (isLoading) {
                // ç”Ÿæˆå”¯ä¸€çš„æ¶ˆæ¯ID
                const messageId = 'loading-message-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9);
                
                // æ–°çš„æ€è€ƒè¿‡ç¨‹æ˜¾ç¤ºæ ¼å¼
                messageDiv.innerHTML = `
                    <div class="thinking-process">
                        <div class="thinking-header">
                            <div class="thinking-icon">ğŸ§ </div>
                            <div class="thinking-title">æ€è€ƒè¿‡ç¨‹</div>
                            <div class="thinking-model">${model || 'WanQianCora'}</div>
                        </div>
                        <div class="thinking-content">
                            <div class="thinking-status">${content}</div>
                            <div class="thinking-realtime" id="thinking-text">å¼€å§‹æ€è€ƒ...</div>
                            <div class="thinking-animation">
                                <div class="thinking-step">åˆ†æé—®é¢˜...</div>
                                <div class="thinking-step">æ£€ç´¢çŸ¥è¯†...</div>
                                <div class="thinking-step">ç”Ÿæˆå›ç­”...</div>
                            </div>
                        </div>
                        <div class="thinking-progress">
                            <div class="progress-bar">
                                <div class="progress-fill"></div>
                            </div>
                            <div class="progress-text">å¤„ç†ä¸­...</div>
                        </div>
                    </div>
                `;
                messageDiv.id = messageId;
            } else if (role === 'ai') {
                // AIæœ€ç»ˆç­”æ¡ˆæ˜¾ç¤ºåœ¨æ€è€ƒè¿‡ç¨‹æ¡†å†…
                messageDiv.innerHTML = `
                    <div class="thinking-process completed">
                        <div class="thinking-header" onclick="toggleThinkingProcess(this)" style="cursor: pointer;">
                            <div class="thinking-icon">âœ…</div>
                            <div class="thinking-title">æ€è€ƒå®Œæˆ</div>
                            <div class="thinking-toggle">â–¼</div>
                        </div>
                        <div class="thinking-content" style="display: none;">
                            <div class="thinking-original" style="max-height: 200px; overflow-y: auto; border: 1px solid #e2e8f0; border-radius: 6px; padding: 12px; margin: 8px 0; background: #f8fafc;">
                                æ— æ€è€ƒè¿‡ç¨‹å†…å®¹
                            </div>
                        </div>
                        <div class="thinking-final" style="margin-top: 12px;">
                            <div style="font-weight: 600; color: #3b82f6; margin-bottom: 8px;">æœ€ç»ˆç­”æ¡ˆï¼š</div>
                            <div class="final-answer" style="max-height: none; min-height: auto; white-space: pre-wrap; word-wrap: break-word;">${parseMarkdown(content)}</div>
                        </div>
                    </div>
                `;
            } else {
                // ç”¨æˆ·æ¶ˆæ¯æ­£å¸¸æ˜¾ç¤º
                messageDiv.innerHTML = parseMarkdown(content);
            }
            
            chatHistory.appendChild(messageDiv);
            chatHistory.scrollTop = chatHistory.scrollHeight;
            
            return messageDiv.id;
        }
        
        // æ›´æ–°åŠ è½½æ¶ˆæ¯
        function updateLoadingMessage(content) {
            const loadingMessage = document.getElementById('loading-message');
            if (loadingMessage) {
                loadingMessage.innerHTML = `<div class="loading">${content}</div>`;
            }
        }
        
        // ç§»é™¤åŠ è½½æ¶ˆæ¯
        function removeLoadingMessage() {
            const loadingMessage = document.getElementById('loading-message');
            if (loadingMessage) {
                loadingMessage.remove();
            }
        }
        
        async function sendMessage() {
            const userInput = document.getElementById('user-input').value;
            
            if (!userInput.trim()) {
                alert('è¯·è¾“å…¥æ¶ˆæ¯å†…å®¹');
                return;
            }
            
            // è·å–é€‰ä¸­çš„æ¨¡å‹
            const selectedModel = document.getElementById('model-select').value;
            
            // æ˜¾ç¤ºç”¨æˆ·æ¶ˆæ¯
            addMessageToChat('user', userInput);
            
            // å°†ç”¨æˆ·æ¶ˆæ¯æ·»åŠ åˆ°èŠå¤©å†å²
            chatHistory.push({ role: 'user', content: userInput });
            
            // æ¸…ç©ºè¾“å…¥æ¡†
            document.getElementById('user-input').value = '';
            
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€å¹¶è·å–loadingId
            const loadingId = addMessageToChat('ai', 'æ­£åœ¨ç”Ÿæˆå›å¤...', true);
            
            try {
                // å‡†å¤‡APIè¯·æ±‚æ•°æ®
                const requestData = {
                    model: selectedModel,
                    messages: chatHistory,
                    stream: false
                };
                

                

                
                // è°ƒç”¨ChatGLM APIï¼Œä½¿ç”¨æµå¼ä¼ è¾“
                const response = await fetch('https://open.bigmodel.cn/api/paas/v4/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${API_KEY}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        ...requestData,
                        stream: true
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`è¯·ç¨åå†è¯• `);
                }
                
                // å¤„ç†æµå¼å“åº”
                const reader = response.body.getReader();
                const decoder = new TextDecoder();
                let fullResponse = '';
                let thinkingContent = ''; // æ€è€ƒè¿‡ç¨‹å†…å®¹
                let finalAnswer = ''; // æœ€ç»ˆç­”æ¡ˆå†…å®¹
                let isThinkingPhase = true; // æ˜¯å¦åœ¨æ€è€ƒé˜¶æ®µ
                
                try {
                    while (true) {
                        const { done, value } = await reader.read();
                        if (done) break;
                        
                        const chunk = decoder.decode(value);
                        const lines = chunk.split('\n');
                        
                        for (const line of lines) {
                            if (line.startsWith('data: ') && line !== 'data: [DONE]') {
                                try {
                                    const data = JSON.parse(line.substring(6));
                                    if (data.choices && data.choices[0] && data.choices[0].delta && data.choices[0].delta.content) {
                                        const content = data.choices[0].delta.content;
                                        fullResponse += content;
                                        
                                        // æ£€æµ‹æ€è€ƒè¿‡ç¨‹æ ‡è®°
                                        if (content.includes('</think>')) {
                                            isThinkingPhase = false;
                                            // ç«‹å³åˆ†ç¦»æ€è€ƒè¿‡ç¨‹å’Œæœ€ç»ˆç­”æ¡ˆ
                                            const parts = fullResponse.split('</think>');
                                            if (parts.length > 1) {
                                                thinkingContent = parts[0].replace('<think>', '').trim();
                                                finalAnswer = parts[1].trim();
                                                // åˆ‡æ¢åˆ°åªæ˜¾ç¤ºæœ€ç»ˆç­”æ¡ˆ
                                                updateMessageContent(loadingId, finalAnswer);
                                            }
                                        } else if (content.includes('</think>')) {
                                            isThinkingPhase = false;
                                            // ç«‹å³åˆ†ç¦»æ€è€ƒè¿‡ç¨‹å’Œæœ€ç»ˆç­”æ¡ˆ
                                            const parts = fullResponse.split('</think>');
                                            if (parts.length > 1) {
                                                thinkingContent = parts[0].replace('<think>', '').trim();
                                                finalAnswer = parts[1].trim();
                                                // åˆ‡æ¢åˆ°åªæ˜¾ç¤ºæœ€ç»ˆç­”æ¡ˆ
                                                updateMessageContent(loadingId, finalAnswer);
                                            }
                                        } else if (isThinkingPhase) {
                                            // æ€è€ƒé˜¶æ®µï¼šåªæ˜¾ç¤ºæ€è€ƒè¿‡ç¨‹ï¼ˆå»æ‰<think>æ ‡è®°ï¼‰
                                            const currentThinking = fullResponse.replace('<think>', '').trim();
                                            updateMessageContent(loadingId, currentThinking);
                                        } else {
                                            // ç­”æ¡ˆé˜¶æ®µï¼šæŒç»­æ›´æ–°æœ€ç»ˆç­”æ¡ˆå†…å®¹
                                            const parts = fullResponse.split('</think>');
                                            if (parts.length > 1) {
                                                finalAnswer = parts[1].trim();
                                            } else {
                                                finalAnswer = fullResponse.replace('<think>', '').trim();
                                            }
                                            updateMessageContent(loadingId, finalAnswer);
                                        }
                                    }
                                } catch (e) {
                                    // å¿½ç•¥JSONè§£æé”™è¯¯
                                }
                            }
                        }
                    }
                } finally {
                    reader.releaseLock();
                }
                
                // å¦‚æœæ²¡æœ‰æ£€æµ‹åˆ°</think>æ ‡è®°ï¼Œä½¿ç”¨å®Œæ•´å“åº”ä½œä¸ºæœ€ç»ˆç­”æ¡ˆ
                if (!finalAnswer) {
                    finalAnswer = fullResponse.replace('<think>', '').trim();
                } else {
                    // å¦‚æœæ£€æµ‹åˆ°äº†æ ‡è®°ï¼Œç¡®ä¿æœ€ç»ˆç­”æ¡ˆæ˜¯æœ€æ–°çš„
                    const parts = fullResponse.split('</think>');
                    if (parts.length > 1) {
                        finalAnswer = parts[1].trim();
                    } else {
                        finalAnswer = fullResponse.replace('<think>', '').trim();
                    }
                }
                
                // ç¡®ä¿æ€è€ƒå†…å®¹æ­£ç¡®æå–
                if (isThinkingPhase) {
                    thinkingContent = fullResponse.replace('<think>', '').trim();
                } else {
                    // å¦‚æœä¸åœ¨æ€è€ƒé˜¶æ®µï¼Œç¡®ä¿æ€è€ƒå†…å®¹æ­£ç¡®
                    const parts = fullResponse.split('</think>');
                    if (parts.length > 1) {
                        thinkingContent = parts[0].replace('<think>', '').trim();
                    } else {
                        const parts2 = fullResponse.split('</think>');
                        if (parts2.length > 1) {
                            thinkingContent = parts2[0].replace('<think>', '').trim();
                        }
                    }
                }
                
                // å°†æœ€ç»ˆç­”æ¡ˆæ·»åŠ åˆ°èŠå¤©å†å²
                chatHistory.push({ role: 'assistant', content: finalAnswer });
                
                // å®Œæˆæ€è€ƒè¿‡ç¨‹ï¼Œæ˜¾ç¤ºæœ€ç»ˆç­”æ¡ˆ
                completeThinkingProcess(loadingId, thinkingContent, finalAnswer);

            } catch (error) {
                console.error('Error:', error);
                updateMessageContent(loadingId, `æœåŠ¡å™¨ç¹å¿™ä¸­ï¼Œ${error.message}`);
            }
        }
        

        
        function scrollToBottom() {
            const chatHistory = document.getElementById('chat-history');
            if (chatHistory) {
                chatHistory.scrollTop = chatHistory.scrollHeight;
            }
        }
        
        function updateMessageContent(elementId, newContent) {
            const element = document.getElementById(elementId);
            if (element) {
                // å¦‚æœæ˜¯æ€è€ƒè¿‡ç¨‹æ¶ˆæ¯ï¼Œæ›´æ–°å®æ—¶æ€è€ƒæ–‡å­—
                const thinkingRealtime = element.querySelector('.thinking-realtime');
                if (thinkingRealtime) {
                    thinkingRealtime.textContent = newContent;
                    
                    // è‡ªåŠ¨æ»šåŠ¨åˆ°æœ€æ–°å†…å®¹
                    thinkingRealtime.scrollTop = thinkingRealtime.scrollHeight;
                } else {
                    // å¦‚æœä¸æ˜¯æ€è€ƒè¿‡ç¨‹æ¶ˆæ¯ï¼Œæ­£å¸¸æ›´æ–°å†…å®¹
                    element.innerHTML = parseMarkdown(newContent);
                    element.classList.remove('loading');
                }
                scrollToBottom();
            }
        }
        
        // å®Œæˆæ€è€ƒè¿‡ç¨‹ï¼Œæ˜¾ç¤ºæœ€ç»ˆç­”æ¡ˆ
        function completeThinkingProcess(elementId, thinkingContent, finalAnswer) {
            const element = document.getElementById(elementId);
            if (element && element.querySelector('.thinking-process')) {
                // ä¿æŒæ€è€ƒè¿‡ç¨‹æ¡†ï¼Œä½†æ·»åŠ æŠ˜å åŠŸèƒ½
                const thinkingProcess = element.querySelector('.thinking-process');
                
                // åˆ›å»ºæŠ˜å /å±•å¼€çš„ç•Œé¢ - æœ€ç»ˆç­”æ¡ˆå§‹ç»ˆæ˜¾ç¤ºï¼Œæ€è€ƒè¿‡ç¨‹å¯æŠ˜å 
                thinkingProcess.innerHTML = `
                    <div class="thinking-process completed">
                        <div class="thinking-header" onclick="toggleThinkingProcess(this)" style="cursor: pointer;">
                            <div class="thinking-icon">âœ…</div>
                            <div class="thinking-title">æ€è€ƒå®Œæˆ</div>
                            <div class="thinking-toggle">â–¼</div>
                        </div>
                        <div class="thinking-content" style="display: none;">
                            <div class="thinking-original" style="max-height: 200px; overflow-y: auto; border: 1px solid #e2e8f0; border-radius: 6px; padding: 12px; margin: 8px 0; background: #f8fafc;">
                                ${thinkingContent ? parseMarkdown(thinkingContent) : 'æ— æ€è€ƒè¿‡ç¨‹å†…å®¹'}
                            </div>
                        </div>
                        <div class="thinking-final" style="margin-top: 12px;">
                            <div style="font-weight: 600; color: #3b82f6; margin-bottom: 8px;">æœ€ç»ˆç­”æ¡ˆï¼š</div>
                            <div class="final-answer" style="max-height: none; min-height: auto; white-space: pre-wrap; word-wrap: break-word;">${parseMarkdown(finalAnswer)}</div>
                        </div>
                    </div>
                `;
                
                element.classList.remove('loading');
                scrollToBottom();
            }
        }
        
        // åˆ‡æ¢æ€è€ƒè¿‡ç¨‹çš„æŠ˜å /å±•å¼€
        function toggleThinkingProcess(headerElement) {
            const thinkingProcess = headerElement.closest('.thinking-process');
            const content = thinkingProcess.querySelector('.thinking-content');
            const toggleIcon = headerElement.querySelector('.thinking-toggle');
            
            if (content.style.display === 'none') {
                // å±•å¼€
                content.style.display = 'block';
                toggleIcon.textContent = 'â–²';
                toggleIcon.style.transform = 'rotate(0deg)';
            } else {
                // æŠ˜å 
                content.style.display = 'none';
                toggleIcon.textContent = 'â–¼';
                toggleIcon.style.transform = 'rotate(0deg)';
            }
        }
        
        // å…è®¸é€šè¿‡å›è½¦é”®å‘é€æ¶ˆæ¯
        document.getElementById('user-input').addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });

        // è¾“å…¥æ¡†è‡ªåŠ¨è°ƒæ•´é«˜åº¦
        function autoResizeTextarea() {
            const textarea = document.getElementById('user-input');
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 200) + 'px';
        }

        // ç›‘å¬è¾“å…¥æ¡†è¾“å…¥äº‹ä»¶ï¼Œè‡ªåŠ¨è°ƒæ•´é«˜åº¦
        document.getElementById('user-input').addEventListener('input', autoResizeTextarea);

        // ç›‘å¬è¾“å…¥æ¡†èšç„¦äº‹ä»¶ï¼Œåˆå§‹è°ƒæ•´é«˜åº¦
        document.getElementById('user-input').addEventListener('focus', autoResizeTextarea);

        // ç›‘å¬è¾“å…¥æ¡†ç²˜è´´äº‹ä»¶ï¼Œè‡ªåŠ¨è°ƒæ•´é«˜åº¦
        document.getElementById('user-input').addEventListener('paste', function() {
            setTimeout(autoResizeTextarea, 10);
        });
        
        // æ»šåŠ¨åˆ°åº•éƒ¨çš„å‡½æ•°
        function scrollToBottom() {
            const chatContainer = document.querySelector('.chat-container');
            if (chatContainer) {
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }
        }
        
        // è®¾ç½®è‡ªåŠ¨æ»šåŠ¨
        function setupAutoScroll() {
            const chatHistory = document.getElementById('chat-history');
            const chatContainer = document.querySelector('.chat-container');
            
            if (chatHistory && chatContainer) {
                // ç›‘å¬å†…å®¹å˜åŒ–ï¼Œæ–°æ¶ˆæ¯å‡ºç°æ—¶æ»šåŠ¨åˆ°åº•éƒ¨
                const observer = new MutationObserver(() => {
                    scrollToBottom();
                });
                
                observer.observe(chatHistory, {
                    childList: true,
                    subtree: true
                });
                
                // åˆå§‹æ»šåŠ¨åˆ°åº•éƒ¨
                scrollToBottom();
            }
        }
        
        function isMobileDevice() {
            return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || 
                   window.innerWidth <= 768;
        }
        
        // è®¾ç½®ç§»åŠ¨ç«¯é€‚é…
        function setupMobileAdaptation() {
            if (isMobileDevice()) {
                // éšè—åŸå¯¼èˆªæ 
                const navbar = document.querySelector('.navbar');
                if (navbar) {
                    navbar.style.display = 'none';
                }
                
                // è°ƒæ•´èŠå¤©å®¹å™¨
                const chatContainer = document.querySelector('.chat-container');
                if (chatContainer) {
                    chatContainer.style.top = '0';
                    chatContainer.style.bottom = '0';
                    chatContainer.style.left = '0';
                    chatContainer.style.right = '0';
                }
                
                // è°ƒæ•´è¾“å…¥å®¹å™¨
                const inputContainer = document.querySelector('.input-container');
                if (inputContainer) {
                    inputContainer.style.bottom = '0';
                    inputContainer.style.left = '0';
                    inputContainer.style.right = '0';
                }
                
                // è°ƒæ•´æ¶ˆæ¯å®½åº¦
                const messages = document.querySelectorAll('.message');
                messages.forEach(msg => {
                    msg.style.maxWidth = '90%';
                });
            }
        }
        
        // é¡µé¢åˆ‡æ¢åŠŸèƒ½
        function switchPage(pageId) {
            // éšè—æ‰€æœ‰é¡µé¢
            const pages = document.querySelectorAll('.content-section');
            pages.forEach(page => {
                page.classList.remove('active');
            });
            
            // æ˜¾ç¤ºé€‰ä¸­çš„é¡µé¢
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.classList.add('active');
            }
            
            // æ›´æ–°ä¾§è¾¹æ æŒ‰é’®çŠ¶æ€
            const sidebarItems = document.querySelectorAll('.sidebar-item');
            sidebarItems.forEach(item => {
                item.classList.remove('active');
            });
            
            // æ ¹æ®é¡µé¢IDæ‰¾åˆ°å¯¹åº”çš„ä¾§è¾¹æ æŒ‰é’®å¹¶æ¿€æ´»
            const pageIndex = getPageIndex(pageId);
            if (pageIndex >= 0 && sidebarItems[pageIndex]) {
                sidebarItems[pageIndex].classList.add('active');
            }
            
            // æ§åˆ¶è¾“å…¥åŒºåŸŸçš„æ˜¾ç¤º
            const inputContainer = document.querySelector('.input-container');
            if (pageId === 'current-chat') {
                inputContainer.classList.remove('hidden');
            } else {
                inputContainer.classList.add('hidden');
            }
        }
        
        // è·å–é¡µé¢ç´¢å¼•
        function getPageIndex(pageId) {
            const pageMap = {
                'current-chat': 0,
                'chat-history-page': 1,
                'settings-page': 2,
                'help-page': 3,
                'search-page': 4
            };
            return pageMap[pageId] || -1;
        }
        
        // è®¾ç½®ä¾§è¾¹æ æŒ‰é’®ç‚¹å‡»äº‹ä»¶
        function setupSidebarButtons() {
            const sidebarItems = document.querySelectorAll('.sidebar-item');
            const pageIds = ['current-chat', 'chat-history-page', 'settings-page', 'help-page', 'search-page'];
            
            sidebarItems.forEach((item, index) => {
                item.addEventListener('click', function() {
                    switchPage(pageIds[index]);
                });
            });
        }
        
        // æœç´¢åŠŸèƒ½
        function performSearch() {
            const searchInput = document.getElementById('search-input');
            const searchTerm = searchInput.value.trim();
            
            if (searchTerm) {
                alert('æœç´¢åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­ï¼Œæœç´¢å…³é”®è¯ï¼š' + searchTerm);
            } else {
                alert('è¯·è¾“å…¥æœç´¢å…³é”®è¯');
            }
        }
        
        // ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½
        function switchTheme(theme) {
            const body = document.body;
            
            if (theme === 'dark') {
                body.classList.add('dark-theme');
                localStorage.setItem('theme', 'dark');
            } else {
                body.classList.remove('dark-theme');
                localStorage.setItem('theme', 'light');
            }
        }
        
        // åˆå§‹åŒ–ä¸»é¢˜
        function initTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            switchTheme(savedTheme);
            
            // è®¾ç½®ä¸»é¢˜é€‰æ‹©å™¨çš„å€¼
            const themeSelect = document.getElementById('theme-select');
            if (themeSelect) {
                themeSelect.value = savedTheme;
                themeSelect.addEventListener('change', function() {
                    switchTheme(this.value);
                });
            }
        }
        
        // ç§»åŠ¨ç«¯èœå•åˆ‡æ¢
        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobile-nav-menu');
            if (mobileMenu) {
                mobileMenu.classList.toggle('active');
                
                // é˜²æ­¢èƒŒæ™¯æ»šåŠ¨
                if (mobileMenu.classList.contains('active')) {
                    document.body.style.overflow = 'hidden';
                } else {
                    document.body.style.overflow = '';
                }
            }
        }
        
        // ç§»åŠ¨ç«¯ç‚¹å‡»å¤–éƒ¨å…³é—­èœå•
        function setupMobileMenuClose() {
            const mobileMenu = document.getElementById('mobile-nav-menu');
            if (mobileMenu) {
                mobileMenu.addEventListener('click', function(e) {
                    if (e.target === mobileMenu) {
                        toggleMobileMenu();
                    }
                });
            }
        }
        
        // ç§»åŠ¨ç«¯é€‚é…åˆå§‹åŒ–
        function initMobileAdaptation() {
            // æ£€æµ‹æ˜¯å¦ä¸ºç§»åŠ¨è®¾å¤‡
            if (isMobileDevice()) {
                // æ˜¾ç¤ºç§»åŠ¨ç«¯èœå•æŒ‰é’®
                const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
                if (mobileMenuBtn) {
                    mobileMenuBtn.style.display = 'block';
                }
                
                // éšè—æ¡Œé¢ç«¯å¯¼èˆªèœå•
                const navMenu = document.querySelector('.nav-menu');
                if (navMenu) {
                    navMenu.style.display = 'none';
                }
                
                // è°ƒæ•´ä¾§è¾¹æ ä¸ºåº•éƒ¨å¯¼èˆª
                const sidebar = document.querySelector('.sidebar');
                if (sidebar) {
                    sidebar.style.display = 'flex';
                }
                
                // è°ƒæ•´ä¸»å†…å®¹åŒºåŸŸ
                const mainContent = document.querySelector('.main-content');
                if (mainContent) {
                    mainContent.style.marginBottom = '60px';
                    mainContent.style.height = 'calc(100vh - 60px)';
                    mainContent.style.overflow = 'hidden';
                }
                
                // è°ƒæ•´èŠå¤©å®¹å™¨é«˜åº¦
                const chatContainer = document.querySelector('.chat-container');
                if (chatContainer) {
                    chatContainer.style.height = 'calc(100vh - 60px - 80px)';
                    chatContainer.style.overflow = 'hidden';
                }
                
                // è°ƒæ•´èŠå¤©å†å²åŒºåŸŸ
                const chatHistory = document.getElementById('chat-history');
                if (chatHistory) {
                    chatHistory.style.height = '100%';
                    chatHistory.style.overflowY = 'auto';
                    chatHistory.style.paddingBottom = '80px';
                    chatHistory.style.boxSizing = 'border-box';
                }
                
                // è°ƒæ•´è¾“å…¥å®¹å™¨ä½ç½®
                const inputContainer = document.querySelector('.input-container');
                if (inputContainer) {
                    inputContainer.style.position = 'fixed';
                    inputContainer.style.bottom = '60px';
                    inputContainer.style.left = '0';
                    inputContainer.style.right = '0';
                    inputContainer.style.zIndex = '100';
                    inputContainer.style.height = '80px';
                    inputContainer.style.boxSizing = 'border-box';
                }
            } else {
                // æ¡Œé¢ç«¯éšè—ç§»åŠ¨ç«¯èœå•æŒ‰é’®
                const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
                if (mobileMenuBtn) {
                    mobileMenuBtn.style.display = 'none';
                }
                
                // æ˜¾ç¤ºæ¡Œé¢ç«¯å¯¼èˆªèœå•
                const navMenu = document.querySelector('.nav-menu');
                if (navMenu) {
                    navMenu.style.display = 'flex';
                }
                
                // é‡ç½®ä¸»å†…å®¹åŒºåŸŸ
                const mainContent = document.querySelector('.main-content');
                if (mainContent) {
                    mainContent.style.height = '';
                    mainContent.style.overflow = '';
                }
                
                // é‡ç½®èŠå¤©å®¹å™¨é«˜åº¦
                const chatContainer = document.querySelector('.chat-container');
                if (chatContainer) {
                    chatContainer.style.height = '';
                    chatContainer.style.overflow = '';
                }
                
                // é‡ç½®èŠå¤©å†å²åŒºåŸŸ
                const chatHistory = document.getElementById('chat-history');
                if (chatHistory) {
                    chatHistory.style.height = '';
                    chatHistory.style.overflowY = '';
                    chatHistory.style.paddingBottom = '';
                    chatHistory.style.boxSizing = '';
                }
                
                // é‡ç½®è¾“å…¥å®¹å™¨ä½ç½®
                const inputContainer = document.querySelector('.input-container');
                if (inputContainer) {
                    inputContainer.style.position = '';
                    inputContainer.style.bottom = '';
                    inputContainer.style.left = '';
                    inputContainer.style.right = '';
                    inputContainer.style.zIndex = '';
                    inputContainer.style.height = '';
                    inputContainer.style.boxSizing = '';
                }
            }
        }
        
        // çª—å£å¤§å°å˜åŒ–ç›‘å¬
        function setupWindowResizeListener() {
            window.addEventListener('resize', function() {
                initMobileAdaptation();
            });
        }
        
        // åˆå§‹åŒ–æ‰€æœ‰è®¾ç½®
        function initSettings() {
            // å­—ä½“å¤§å°è®¾ç½®
            const fontSizeSelect = document.getElementById('font-size-select');
            const savedFontSize = localStorage.getItem('fontSize') || 'medium';
            if (fontSizeSelect) {
                fontSizeSelect.value = savedFontSize;
                switchFontSize(savedFontSize);
                fontSizeSelect.addEventListener('change', function() {
                    switchFontSize(this.value);
                    localStorage.setItem('fontSize', this.value);
                });
            }
            
            // è‡ªåŠ¨ä¿å­˜è®¾ç½®
            const autoSaveSelect = document.getElementById('auto-save-select');
            const savedAutoSave = localStorage.getItem('autoSave') || 'enabled';
            if (autoSaveSelect) {
                autoSaveSelect.value = savedAutoSave;
                autoSaveSelect.addEventListener('change', function() {
                    localStorage.setItem('autoSave', this.value);
                });
            }
            
            // æ˜¾ç¤ºæ€è€ƒè¿‡ç¨‹è®¾ç½®
            const showThinkingSelect = document.getElementById('show-thinking-select');
            const savedShowThinking = localStorage.getItem('showThinking') || 'enabled';
            if (showThinkingSelect) {
                showThinkingSelect.value = savedShowThinking;
                switchShowThinking(savedShowThinking);
                showThinkingSelect.addEventListener('change', function() {
                    switchShowThinking(this.value);
                    localStorage.setItem('showThinking', this.value);
                });
            }
            
            // æ¶ˆæ¯åŠ¨ç”»è®¾ç½®
            const messageAnimationSelect = document.getElementById('message-animation-select');
            const savedMessageAnimation = localStorage.getItem('messageAnimation') || 'enabled';
            if (messageAnimationSelect) {
                messageAnimationSelect.value = savedMessageAnimation;
                switchMessageAnimation(savedMessageAnimation);
                messageAnimationSelect.addEventListener('change', function() {
                    switchMessageAnimation(this.value);
                    localStorage.setItem('messageAnimation', this.value);
                });
            }
            
            // APIå¯†é’¥è®¾ç½®
            const apiKeyInput = document.getElementById('api-key-input');
            const savedApiKey = localStorage.getItem('apiKey') || '';
            if (apiKeyInput) {
                apiKeyInput.value = savedApiKey;
                apiKeyInput.addEventListener('change', function() {
                    localStorage.setItem('apiKey', this.value);
                });
            }
            
            // APIç«¯ç‚¹è®¾ç½®
            const apiEndpointInput = document.getElementById('api-endpoint-input');
            const savedApiEndpoint = localStorage.getItem('apiEndpoint') || '';
            if (apiEndpointInput) {
                apiEndpointInput.value = savedApiEndpoint;
                apiEndpointInput.addEventListener('change', function() {
                    localStorage.setItem('apiEndpoint', this.value);
                });
            }
            
            // æœ€å¤§ä¸Šä¸‹æ–‡é•¿åº¦è®¾ç½®
            const maxContextInput = document.getElementById('max-context-input');
            const savedMaxContext = localStorage.getItem('maxContext') || '4000';
            if (maxContextInput) {
                maxContextInput.value = savedMaxContext;
                maxContextInput.addEventListener('change', function() {
                    localStorage.setItem('maxContext', this.value);
                });
            }
            
            // æ¸©åº¦è®¾ç½®
            const temperatureSlider = document.getElementById('temperature-slider');
            const temperatureValue = document.getElementById('temperature-value');
            const savedTemperature = localStorage.getItem('temperature') || '0.7';
            if (temperatureSlider && temperatureValue) {
                temperatureSlider.value = savedTemperature;
                temperatureValue.textContent = savedTemperature;
                temperatureSlider.addEventListener('input', function() {
                    temperatureValue.textContent = this.value;
                    localStorage.setItem('temperature', this.value);
                });
            }
        }
        
        // åˆ‡æ¢å­—ä½“å¤§å°
        function switchFontSize(size) {
            const body = document.body;
            body.classList.remove('font-small', 'font-medium', 'font-large');
            body.classList.add(`font-${size}`);
        }
        
        // åˆ‡æ¢æ€è€ƒè¿‡ç¨‹æ˜¾ç¤º
        function switchShowThinking(show) {
            const body = document.body;
            if (show === 'disabled') {
                body.classList.add('hide-thinking');
            } else {
                body.classList.remove('hide-thinking');
            }
        }
        
        // åˆ‡æ¢æ¶ˆæ¯åŠ¨ç”»
        function switchMessageAnimation(animation) {
            const body = document.body;
            if (animation === 'disabled') {
                body.classList.add('no-animation');
            } else {
                body.classList.remove('no-animation');
            }
        }
        
        // å¯¼å‡ºè®¾ç½®
        function exportSettings() {
            const settings = {
                theme: localStorage.getItem('theme') || 'light',
                fontSize: localStorage.getItem('fontSize') || 'medium',
                autoSave: localStorage.getItem('autoSave') || 'enabled',
                showThinking: localStorage.getItem('showThinking') || 'enabled',
                messageAnimation: localStorage.getItem('messageAnimation') || 'enabled',
                apiKey: localStorage.getItem('apiKey') || '',
                apiEndpoint: localStorage.getItem('apiEndpoint') || '',
                maxContext: localStorage.getItem('maxContext') || '4000',
                temperature: localStorage.getItem('temperature') || '0.7'
            };
            
            const dataStr = JSON.stringify(settings, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = 'wanqiancora-settings.json';
            link.click();
        }
        
        // å¯¼å…¥è®¾ç½®
        function importSettings() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const settings = JSON.parse(e.target.result);
                        
                        // åº”ç”¨è®¾ç½®
                        Object.keys(settings).forEach(key => {
                            localStorage.setItem(key, settings[key]);
                        });
                        
                        // é‡æ–°åˆå§‹åŒ–è®¾ç½®
                        initSettings();
                        initTheme();
                        
                        alert('è®¾ç½®å¯¼å…¥æˆåŠŸï¼');
                    } catch (error) {
                        alert('å¯¼å…¥å¤±è´¥ï¼šæ–‡ä»¶æ ¼å¼é”™è¯¯');
                    }
                };
                reader.readAsText(file);
            };
            
            input.click();
        }
        
        // é‡ç½®è®¾ç½®
        function resetSettings() {
            if (confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰è®¾ç½®å—ï¼Ÿè¿™å°†æ¸…é™¤æ‰€æœ‰è‡ªå®šä¹‰è®¾ç½®ã€‚')) {
                // æ¸…é™¤æ‰€æœ‰è®¾ç½®
                localStorage.removeItem('theme');
                localStorage.removeItem('fontSize');
                localStorage.removeItem('autoSave');
                localStorage.removeItem('showThinking');
                localStorage.removeItem('messageAnimation');
                localStorage.removeItem('apiKey');
                localStorage.removeItem('apiEndpoint');
                localStorage.removeItem('maxContext');
                localStorage.removeItem('temperature');
                
                // é‡æ–°åˆå§‹åŒ–è®¾ç½®
                initSettings();
                initTheme();
                
                alert('è®¾ç½®å·²é‡ç½®ä¸ºé»˜è®¤å€¼ï¼');
            }
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåè®¾ç½®è‡ªåŠ¨æ»šåŠ¨å’Œç§»åŠ¨ç«¯é€‚é…
        document.addEventListener('DOMContentLoaded', function() {
            setupAutoScroll();
            scrollToBottom();
            setupSidebarButtons(); // åˆå§‹åŒ–ä¾§è¾¹æ æŒ‰é’®
            initTheme(); // åˆå§‹åŒ–ä¸»é¢˜
            initSettings(); // åˆå§‹åŒ–æ‰€æœ‰è®¾ç½®
            initMobileAdaptation(); // åˆå§‹åŒ–ç§»åŠ¨ç«¯é€‚é…
            setupMobileMenuClose(); // è®¾ç½®ç§»åŠ¨ç«¯èœå•å…³é—­åŠŸèƒ½
            setupWindowResizeListener(); // è®¾ç½®çª—å£å¤§å°å˜åŒ–ç›‘å¬
        });
        
        // é˜²æ­¢F12æŸ¥çœ‹æºä»£ç 
        document.addEventListener('keydown', function(e) {
            // ç¦ç”¨F12é”®
            if (e.key === 'F12' || e.keyCode === 123) {
                e.preventDefault();
                return false;
            }
            // ç¦ç”¨Ctrl+Shift+I (å¼€å‘è€…å·¥å…·)
            if (e.ctrlKey && e.shiftKey && e.key === 'I') {
                e.preventDefault();
                return false;
            }
            // ç¦ç”¨Ctrl+Shift+J (æ§åˆ¶å°)
            if (e.ctrlKey && e.shiftKey && e.key === 'J') {
                e.preventDefault();
                return false;
            }
            // ç¦ç”¨Ctrl+U (æŸ¥çœ‹æºä»£ç )
            if (e.ctrlKey && e.key === 'U') {
                e.preventDefault();
                return false;
            }
        });

        // ç¦ç”¨å³é”®èœå•
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
            return false;
        });

        // ç¦ç”¨æ–‡æœ¬é€‰æ‹©å’Œå¤åˆ¶
        document.addEventListener('selectstart', function(e) {
            e.preventDefault();
            return false;
        });

        // ç¦ç”¨æ‹–æ‹½
        document.addEventListener('dragstart', function(e) {
            e.preventDefault();
            return false;
        });

        // å¤åˆ¶ä»£ç åŠŸèƒ½
        function copyCode(button) {
            const codeBlock = button.previousElementSibling;
            const codeText = codeBlock.textContent;
            
            navigator.clipboard.writeText(codeText).then(() => {
                const originalText = button.textContent;
                button.textContent = 'å·²å¤åˆ¶!';
                
                setTimeout(() => {
                    button.textContent = originalText;
                }, 2000);
            }).catch(err => {
                console.error('å¤åˆ¶å¤±è´¥:', err);
                button.textContent = 'å¤åˆ¶å¤±è´¥';
            });
        }
        

    </script>
</body>
</html>