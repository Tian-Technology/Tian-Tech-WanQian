<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>WanQian7--ä¸–ç•Œä¸‡åƒé—®é¢˜ï¼Œæˆ‘æœ‰ç­”æ¡ˆ</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* ç°ä»£åŒ–å¯¼èˆªæ æ ·å¼ */
        .navbar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 8px 0;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 30px;
        }
        
        .nav-logo {
            color: white;
            font-size: 1.8rem;
            font-weight: 700;
            text-decoration: none;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            font-family: 'SF Pro Display', 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            letter-spacing: -0.5px;
        }
        
        .nav-menu {
            display: flex;
            list-style: none;
            margin: 0;
            padding: 0;
            gap: 25px;
        }
        
        .nav-menu li a {
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
        }
        
        .nav-menu li a:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
            color: white;
        }
        
        /* ç°ä»£åŒ–bodyæ ·å¼ */
        body {
            font-family: 'Inter', 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            font-size: 16px;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            color: #2d3748;
            height: 100vh;
            width: 100vw;
            display: flex;
            flex-direction: column;
            padding-top: 0;
            overflow: auto;
        }
        
        .container {
            background: rgba(255, 255, 255, 0.95);
            flex: 1;
            display: flex;
            padding: 0px;
            margin: 0px;
            margin-top: 0px;
            border-radius: 0px;
            box-shadow: none;
            backdrop-filter: blur(20px);
            border: none;
            height: 100vh;
            width: 100vw;
        }
        
        /* Main Content Styles */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        h1 {
            color: #2d3748;
            text-align: center;
            margin-bottom: 30px;
            font-weight: 700;
            font-size: 2.2rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            font-family: 'SF Pro Display', sans-serif;
            letter-spacing: -0.5px;
        }
        
        .chat-container {
            position: fixed;
            top: 25px;
            left: 8px;
            right: 8px;
            bottom: 190px; /* å¢åŠ åº•éƒ¨é—´è·ï¼Œç¡®ä¿ä¸é®æŒ¡ */
            padding: 0px;
            overflow-y: auto;
            background: rgba(248, 250, 252, 0.9);
            border-radius: 8px;
            box-shadow: none;
            display: flex;
            flex-direction: column;
            min-height: 0;
            border: none;
            margin: 0px;
            /* ç¡®ä¿flexå®¹å™¨æ­£ç¡®æ»šåŠ¨ */
            flex: 1;
            /* è‡ªå®šä¹‰æ»šåŠ¨æ¡æ ·å¼ */
            scrollbar-width: thin;
            scrollbar-color: #667eea rgba(0, 0, 0, 0.1);
            z-index: 90; /* ç¡®ä¿åœ¨è¾“å…¥æ¡†ä¸‹æ–¹ */
        }
        
        .chat-container::-webkit-scrollbar {
            width: 8px;
        }
        
        .chat-container::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.1);
            border-radius: 4px;
        }
        
        .chat-container::-webkit-scrollbar-thumb {
            background: #667eea;
            border-radius: 4px;
        }
        
        .chat-container::-webkit-scrollbar-thumb:hover {
            background: #764ba2;
        }
        
        .message {
            margin-bottom: 25px;
            padding: 18px 24px;
            border-radius: 22px;
            word-wrap: break-word;
            font-family: 'Inter', 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            font-size: 16px;
            line-height: 1.7;
            animation: fadeInUp 0.4s ease-out;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .message:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.18);
        }
        
        @keyframes fadeInUp {
            from { 
                opacity: 0; 
                transform: translateY(20px) scale(0.95);
            }
            to { 
                opacity: 1; 
                transform: translateY(0) scale(1);
            }
        }
        
        .user-message {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            margin-left: auto;
            max-width: 78%;
            border-bottom-right-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .ai-message {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(242, 242, 242, 0.95) 100%);
            color: #2d3748 !important;
            max-width: 78%;
            border-bottom-left-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        /* ç²¾ç¡®æ§åˆ¶æ ·å¼ */
        .ai-message {
            color: #2d3748 !important;
            font-style: normal !important;
        }
        
        .ai-message div[style*="background: #f5f5f5"] {
            font-style: italic !important;
            color: #666666 !important;
        }
        
        .ai-message div[style*="background: #f5f5f5"] strong {
            font-style: normal !important;
            color: #2d3748 !important;
        }
        
        /* ç°ä»£åŒ–è¾“å…¥æ¡†å®¹å™¨ */
        .input-container {
            position: fixed;
            left: 8px;
            right: 8px;
            bottom: 0px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 8px 8px 0px 0px;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.05);
            backdrop-filter: blur(20px);
            border: none;
            display: flex;
            flex-direction: column;
            gap: 10px;
            width: auto;
            box-sizing: border-box;
            z-index: 100; /* ç¡®ä¿è¾“å…¥æ¡†åœ¨èŠå¤©å®¹å™¨ä¸Šæ–¹ */
        }
        
        .input-area {
            display: flex;
            gap: 20px;
            align-items: flex-end;
        }
        
        .input-area textarea {
            flex: 1;
        }
        
        .main-content {
            margin-bottom: 180px;
            display: flex;
            flex-direction: column;
            min-height: 0;
        }
        
        textarea {
            flex: 1;
            height: 80px;
            padding: 12px;
            border: 2px solid rgba(102, 126, 234, 0.3);
            border-radius: 16px;
            resize: none;
            font-family: 'Inter', 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            font-size: 16px;
            line-height: 1.6;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            background: rgba(255, 255, 255, 0.9);
            color: #2d3748;
        }
        
        textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.25);
            transform: translateY(-2px);
        }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 16px;
            cursor: pointer;
            font-weight: 600;
            font-size: 16px;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
            font-family: 'SF Pro Display', sans-serif;
            letter-spacing: 0.5px;
            height: 48px;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(102, 126, 234, 0.5);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .loading {
            color: #a0aec0;
            font-style: italic;
            font-size: 15px;
        }
        
        /* æ·±åº¦æ€è€ƒä¸“å±æ ·å¼ */
        .thinking-style {
            background: linear-gradient(135deg, rgba(245, 245, 245, 0.95) 0%, rgba(232, 232, 232, 0.95) 100%) !important;
            border-left: 4px solid #667eea !important;
            font-style: italic !important;
            color: #666666 !important;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1) !important;
        }
        
        h2 {
            color: #2d3748;
            border-bottom: 3px solid #667eea;
            padding-bottom: 12px;
            margin-top: 0;
            font-weight: 700;
            font-size: 1.0rem;
            font-family: 'SF Pro Display', sans-serif;
            letter-spacing: -0.3px;
        }
        
        /* ç°ä»£åŒ–æ¨¡å‹é€‰æ‹©å™¨æ ·å¼ */
        .model-selector {
            position: relative;
            margin-bottom: 8px;
            width: auto;
            max-width: 100%;
            transition: all 0.3s ease;
        }
        
        .model-selector:hover {
            transform: translateY(-2px);
        }
        
        .model-selector label {
            position: absolute;
            top: -12px;
            left: 15px;
            font-weight: 700;
            font-size: 12px;
            color: #2d3748;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(242, 242, 242, æ0.95) 100%);
            padding: 2px 10px;
            border-radius: 16px;
            z-index: 1;
            min-width: 60px;
            text-align: center;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            font-family: 'SF Pro Display', sans-serif;
        }
        
        .model-selector label:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }

        #chat-history {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
            min-height: 0;
        }
        
        .model-selector select {
            width: auto;
            min-width: 250px;
            padding: 12px 20px;
            border: 2px solid rgba(102, 126, 234, 0.3);
            border-radius: 16px;
            background: rgba(255, 255, 255, 0.9);
            font-size: 15px;
            color: #2d3748;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            font-family: 'Inter', sans-serif;
            font-weight: 500;
        }
        
        .model-selector select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.25);
            transform: translateY(-2px);
        }

    </style>
</head>
<body>
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="#" class="nav-logo">WanQian7--ä¸–ç•Œä¸‡åƒé—®é¢˜ï¼Œæˆ‘æœ‰ç­”æ¡ˆ</a>
            <ul class="nav-menu">
                <li><a href="index.html">é¦–é¡µ</a></li>
                <li><a href="WanQiandoc.html">WanQianç‰ˆæœ¬æ—¥å¿—</a></li>
                <li><a href="#" onclick="location.reload(); return false;">æ–°å¯¹è¯</a></li>
            </ul>
        </div>
    </nav>

    <div class="chat-container">
        <h2 style="margin: 0; padding: 10px; background: rgba(255, 255, 255, 0.8); border-bottom: 1px solid rgba(0, 0, 0, 0.1);">å¯¹è¯è®°å½•</h2>
        <div id="chat-history"></div>
    </div>
    
    <div class="input-container">
        <!-- æ¨¡å‹é€‰æ‹©å™¨ -->
        <div class="model-selector">
            <label for="model-select"></label>
            <select id="model-select">
                <option value="glm-z1-flash">WanQian7 Ultra Thinking ProğŸ§ ğŸ”¥</option>
                <option value="glm-z1-flash">WanQian7 Ultra ThinkingğŸ§ ğŸ”¥</option>
                <option value="glm-4.5-flash">WanQian7 Turbo XğŸ”¥</option>
                <option value="glm-4.5-flash">WanQian7 Turbo</option>
                <option value="glm-4.5-flash">WanQian7 Max</option>
                <option value="glm-4.5-flash">WanQian7 SeedğŸ”¥</option>
                <option value="glm-4v-flash">WanQian7 IntelligentğŸ”¥</option>
                <option value="glm-4v-flash">WanQian7 Intelligent Flash</option>
                <option value="glm-4v-flash">WanQian7 VisionğŸ”¥</option>
                <option value="glm-4v-flash">WanQian7 Vision Flash</option>
                <option value="glm-4v-flash">WanQian7 GenevağŸ”¥</option>
                <option value="glm-4v-flash">WanQian7 Geneva Flash</option>
                <option value="glm-4-flash-250414">WanQian7 Maxâš¡ğŸ”¥</option>
                <option value="glm-4-flash-250414">WanQian7 Airâš¡ğŸ”¥</option>
                <option value="glm-4-flash-250414">WanQian7 SC </option>
                <option value="glm-4-flash-250414">WanQian7 E</option>
                <option value="glm-4-flash-250414">WanQian7-0830</option>
                <option value="glm-4-flash-250414">WanQian7 speedğŸ”¥âš¡</option>
                <option value="glm-4-flash-250414">WanQian7âš¡ğŸ”¥</option>
                <option value="cogview-3-flash">WanQian7 Imagine XğŸ–¼ï¸</option>
                <option value="cogview-3-flash">WanQian7 ImagineğŸ–¼ï¸</option>
                <option value="cogvideox-flash">WanQian7 Video XğŸ¥</option>
                <option value="cogvideox-flash">WanQian7 VideoğŸ¥</option>
            </select>
        </div>
        <div class="input-area">
            <textarea id="user-input" placeholder="è¯·è¾“å…¥æ‚¨è¦å‘é€ç»™WanQian7å¤§æ¨¡å‹çš„æ¶ˆæ¯..."></textarea>
            <button onclick="sendMessage()">å‘é€</button>
        </div>
    </div>

    <script>
        // ç®€å•çš„Markdownè§£æå‡½æ•°
        function parseMarkdown(text) {
            // å¤„ç†æ ‡é¢˜
            text = text.replace(/^###### (.+)$/gm, '<h6>$1</h6>');
            text = text.replace(/^##### (.+)$/gm, '<h5>$1</h5>');
            text = text.replace(/^#### (.+)$/gm, '<h4>$1</h4>');
            text = text.replace(/^### (.+)$/gm, '<h3>$1</h3>');
            text = text.replace(/^## (.+)$/gm, '<h2>$1</h2>');
            text = text.replace(/^# (.+)$/gm, '<h1>$1</h1>');
            
            // å¤„ç†ç²—ä½“
            text = text.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            text = text.replace(/__(.*?)__/g, '<strong>$1</strong>');
            
            // å¤„ç†æ–œä½“ï¼ˆç§»é™¤æ–œä½“æ•ˆæœï¼Œä¿æŒæ­£å¸¸å­—ä½“ï¼‰
            text = text.replace(/\*(.*?)\*/g, '<span style="font-style: normal;">$1</span>');
            text = text.replace(/_(.*?)_/g, '<span style="font-style: normal;">$1</span>');
            
            // å¤„ç†åˆ é™¤çº¿
            text = text.replace(/~~(.*?)~~/g, '<del>$1</del>');
            
            // å¤„ç†ä»£ç å—
        text = text.replace(/```([\s\S]*?)```/g, 
            '<div style="position: relative; margin: 10px 0;">' +
            '<pre style="background: #f6f8fa; padding: 16px; border-radius: 6px; overflow-x: auto; border: 1px solid #e1e4e8; margin: 0;"><code>$1</code></pre>' +
            '<button style="position: absolute; top: 8px; right: 8px; background: #0366d6; color: white; border: none; border-radius: 3px; padding: 4px 8px; font-size: 12px; cursor: pointer;" onclick="copyCode(this)">å¤åˆ¶</button>' +
            '</div>');
        text = text.replace(/`([^`]+)`/g, '<code style="background: #f6f8fa; padding: 2px 4px; border-radius: 3px; border: 1px solid #e1e4e8;">$1</code>');
            
            // å¤„ç†å¼•ç”¨
            text = text.replace(/^> (.+)$/gm, '<blockquote>$1</blockquote>');
            
            // å¤„ç†æ— åºåˆ—è¡¨
            text = text.replace(/^(\*|\-|\+) (.+)$/gm, '<li>$2</li>');
            text = text.replace(/(<li>.+<\/li>\s*)+/g, function(match) {
                return '<ul style="margin: 8px 0; padding-left: 20px; line-height: 1.4;">' + match + '</ul>';
            });
            
            // å¤„ç†æœ‰åºåˆ—è¡¨ï¼ˆä¿ç•™æ•°å­—åºå·ï¼‰
            text = text.replace(/^(\d+)\. (.+)$/gm, '<li value="$1">$2</li>');
            text = text.replace(/(<li value="\d+">.+<\/li>\s*)+/g, function(match) {
                return '<ol style="margin: 8px 0; padding-left: 20px; line-height: 1.4;">' + match + '</ol>';
            });
            
            // å¤„ç†é“¾æ¥
            text = text.replace(/\[(.*?)\]\((.*?)\)/g, '<a href="$2" target="_blank">$1</a>');
            
            // å¤„ç†å›¾ç‰‡
            text = text.replace(/!\[(.*?)\]\((.*?)\)/g, '<img src="$2" alt="$1" style="max-width: 100%;">');
            
            // å¤„ç†æ¢è¡Œ
            text = text.replace(/\n/g, '<br>');
            
            return text;
        }
        
        // éšè—çš„APIå¯†é’¥
        const API_KEY = "74f181dfaa934ce5911ffc49ada3563b.aivDJtSXxpLDybs1";
        
        
        // å½“å‰å¯¹è¯çš„èŠå¤©å†å²
        let chatHistory = [];
        
        // æ€è€ƒè®¡æ—¶å™¨
        let thinkingStartTime = 0;
        
        async function sendMessage() {
            const userInput = document.getElementById('user-input').value;
            
            if (!userInput.trim()) {
                alert('è¯·è¾“å…¥æ¶ˆæ¯å†…å®¹');
                return;
            }
            
            // è·å–é€‰ä¸­çš„æ¨¡å‹
            const selectedModel = document.getElementById('model-select').value;
            
            // æ˜¾ç¤ºç”¨æˆ·æ¶ˆæ¯
            addMessageToChat('user', userInput);
            
            // å°†ç”¨æˆ·æ¶ˆæ¯æ·»åŠ åˆ°èŠå¤©å†å²
            chatHistory.push({ role: 'user', content: userInput });
            
            // æ¸…ç©ºè¾“å…¥æ¡†
            document.getElementById('user-input').value = '';
            
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            const loadingId = addMessageToChat('ai', 'æ­£åœ¨ç”Ÿæˆå›å¤...', true, selectedModel);
            
            // å¼€å§‹æ€è€ƒè®¡æ—¶
            thinkingStartTime = Date.now();
            
            // å¦‚æœæ˜¯æ·±åº¦æ€è€ƒæ¨¡å‹ï¼Œç«‹å³åº”ç”¨ä¸“å±æ ·å¼
            // æ³¨æ„ï¼šè¿™é‡Œä¸éœ€è¦é¢å¤–å¤„ç†ï¼Œæ ·å¼ä¼šåœ¨addMessageToChatä¸­åº”ç”¨
            
            try {
                // å‡†å¤‡APIè¯·æ±‚æ•°æ®
                const requestData = {
                    model: selectedModel,
                    messages: chatHistory,
                    stream: false
                };
                

                

                
                // è°ƒç”¨ChatGLM APIï¼Œä½¿ç”¨æµå¼ä¼ è¾“
                const response = await fetch('https://open.bigmodel.cn/api/paas/v4/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${API_KEY}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        ...requestData,
                        stream: true
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`APIè¯·æ±‚å¤±è´¥: ${response.status}`);
                }
                
                // å¤„ç†æµå¼å“åº”
                const reader = response.body.getReader();
                const decoder = new TextDecoder();
                let fullResponse = '';
                
                try {
                    while (true) {
                        const { done, value } = await reader.read();
                        if (done) break;
                        
                        const chunk = decoder.decode(value);
                        const lines = chunk.split('\n');
                        
                        for (const line of lines) {
                            if (line.startsWith('data: ') && line !== 'data: [DONE]') {
                                try {
                                    const data = JSON.parse(line.substring(6));
                                    if (data.choices && data.choices[0] && data.choices[0].delta && data.choices[0].delta.content) {
                                        const content = data.choices[0].delta.content;
                                        fullResponse += content;
                                        // é€å­—æ›´æ–°æ˜¾ç¤º
                                        updateMessageContent(loadingId, fullResponse);
                                    }
                                } catch (e) {
                                    // å¿½ç•¥JSONè§£æé”™è¯¯
                                }
                            }
                        }
                    }
                } finally {
                    reader.releaseLock();
                }
                
                // å°†å®Œæ•´çš„AIå›å¤æ·»åŠ åˆ°èŠå¤©å†å²
                chatHistory.push({ role: 'assistant', content: fullResponse });
                

            } catch (error) {
                console.error('Error:', error);
                updateMessageContent(loadingId, `é”™è¯¯: ${error.message}`);
            }
        }
        
        function addMessageToChat(role, content, isLoading = false, selectedModel = null) {
            const container = document.getElementById('chat-history');
            const messageDiv = document.createElement('div');
            
            if (role === 'user') {
                messageDiv.className = 'message user-message';
            } else if (role === 'ai') {
                messageDiv.className = 'message ai-message';
            }
            
            if (isLoading) {
                messageDiv.className += ' loading';
            }
            
            // å¤„ç†AIå›å¤çš„æ ¼å¼ï¼Œç‰¹åˆ«æ˜¯æ·±åº¦æ€è€ƒæ¨¡å‹çš„è¾“å‡º
            if (role === 'ai' && !isLoading) {
                // è®¡ç®—æ€è€ƒç”¨æ—¶ï¼ˆä»å¼€å§‹æ€è€ƒåˆ°å“åº”å®Œæˆçš„å®Œæ•´æ—¶é—´ï¼‰
            const thinkingTime = thinkingStartTime ? 
                Math.round((Date.now() - thinkingStartTime) / 1000) : 0;
                
                // æ ¼å¼åŒ–æ·±åº¦æ€è€ƒè¿‡ç¨‹ï¼Œä¿ç•™æ€è€ƒå†…å®¹ä½†æ”¹å–„æ˜¾ç¤º
                const formattedContent = content.replace(/<think>([\s\S]*?)<\/think>/g, 
                    '<div style="color: #333; margin-bottom: 10px; padding: 8px; background: #f5f5f5; border-radius: 4px; border-left: 3px solid #64ffda;">' + 
                    '<strong>æ€è€ƒè¿‡ç¨‹:</strong> <span style="color: #666; font-size: 12px;">(å·²æ·±åº¦æ€è€ƒï¼Œç”¨æ—¶ ' + thinkingTime + ' ç§’)</span><br>' + 
                    '$1' + 
                    '</div>');
                // è§£æMarkdownæ ¼å¼
                messageDiv.innerHTML = parseMarkdown(formattedContent || content);
                
                // å¦‚æœæ˜¯æ·±åº¦æ€è€ƒæ¨¡å‹ï¼Œç§»é™¤ä¸“å±æ ·å¼ï¼Œæ¢å¤æ­£å¸¸æ ·å¼
                // ä»…åœ¨å®Œæˆæ€è€ƒåç§»é™¤æ ·å¼
                if (!isLoading && messageDiv.classList.contains('thinking-style')) {
                    messageDiv.classList.remove('thinking-style');
                }
            } else {
                // ç”¨æˆ·æ¶ˆæ¯ä¹Ÿæ”¯æŒåŸºæœ¬æ ¼å¼
                messageDiv.innerHTML = parseMarkdown(content);
            }
            
            // ä¼˜å…ˆåº”ç”¨åŸºç¡€æ ·å¼
            if (selectedModel && selectedModel.includes('Thinking')) {
                messageDiv.classList.add('thinking-style');
            }
            // åè®¾ç½®å†…å®¹é¿å…è¦†ç›–
            
            // ä¸ºåŠ è½½çŠ¶æ€çš„æ¶ˆæ¯åˆ†é…ä¸€ä¸ªIDï¼Œä»¥ä¾¿åç»­æ›´æ–°
            if (isLoading) {
                const loadingId = 'loading-' + Date.now();
                messageDiv.id = loadingId;
                container.appendChild(messageDiv);
                
                // ç«‹å³æ»šåŠ¨åˆ°åº•éƒ¨ï¼Œä½¿ç”¨å¤šç§æ–¹æ³•ç¡®ä¿æˆåŠŸ
                scrollToBottom();
                
                // å¼ºåˆ¶DOMæ›´æ–°åå†æ¬¡æ»šåŠ¨
                setTimeout(() => {
                    scrollToBottom();
                }, 10);
                
                return loadingId;
            }
            
            container.appendChild(messageDiv);
            
            // ç«‹å³æ»šåŠ¨åˆ°åº•éƒ¨ï¼Œä½¿ç”¨å¤šç§æ–¹æ³•ç¡®ä¿æˆåŠŸ
            scrollToBottom();
            
            // å¼ºåˆ¶DOMæ›´æ–°åå†æ¬¡æ»šåŠ¨
            setTimeout(() => {
                scrollToBottom();
            }, 10);
            
            return messageDiv.id;
        }
        
        function updateMessageContent(elementId, newContent) {
            const element = document.getElementById(elementId);
            if (element) {
                // ä¿å­˜å½“å‰çš„æ€è€ƒæ ·å¼çŠ¶æ€
                const wasThinkingStyle = element.classList.contains('thinking-style');
                
                // å¤„ç†AIå›å¤çš„æ ¼å¼ï¼Œç‰¹åˆ«æ˜¯æ·±åº¦æ€è€ƒæ¨¡å‹çš„è¾“å‡º
                if (element.className.includes('ai-message')) {
                    // è®¡ç®—æ€è€ƒç”¨æ—¶ï¼ˆä»å¼€å§‹æ€è€ƒåˆ°å“åº”å®Œæˆçš„å®Œæ•´æ—¶é—´ï¼‰
                    const thinkingTime = thinkingStartTime ? 
                        Math.round((Date.now() - thinkingStartTime) / 1000) : 0;
                    
                    // æ ¼å¼åŒ–æ·±åº¦æ€è€ƒè¿‡ç¨‹ï¼Œä¿ç•™æ€è€ƒå†…å®¹ä½†æ”¹å–„æ˜¾ç¤º
                    const formattedContent = newContent.replace(/<think>([\s\S]*?)<\/think>/g, 
                        '<div style="color: #333; margin-bottom: 10px; padding: 8px; background: #f5f5f5; border-radius: 4px; border-left: 3px solid #64ffda;">' + 
                        '<strong>æ€è€ƒè¿‡ç¨‹:</strong> <span style="color: #666; font-size: 12px;">(å·²æ·±åº¦æ€è€ƒï¼Œç”¨æ—¶ ' + thinkingTime + ' ç§’)</span><br>' + 
                        '$1' + 
                        '</div>');
                    // è§£æMarkdownæ ¼å¼
                    element.innerHTML = parseMarkdown(formattedContent || newContent);
                } else {
                    // ç”¨æˆ·æ¶ˆæ¯ä¹Ÿæ”¯æŒåŸºæœ¬æ ¼å¼
                    element.innerHTML = parseMarkdown(newContent);
                }
                
                // é‡æ–°åº”ç”¨æ€è€ƒæ ·å¼ï¼ˆå¦‚æœä¹‹å‰æœ‰çš„è¯ï¼‰
                if (wasThinkingStyle) {
                    element.classList.add('thinking-style');
                }
                
                // åªæœ‰åœ¨å†…å®¹å®Œå…¨æ¥æ”¶åæ‰ç§»é™¤loadingçŠ¶æ€
                if (!element.className.includes('loading')) {
                    element.classList.remove('loading');
                }
                
                // ç«‹å³æ»šåŠ¨åˆ°åº•éƒ¨
                scrollToBottom();
                
                // å¼ºåˆ¶DOMæ›´æ–°åå†æ¬¡æ»šåŠ¨
                setTimeout(() => {
                    scrollToBottom();
                }, 10);
            }
        }
        
        // å…è®¸é€šè¿‡å›è½¦é”®å‘é€æ¶ˆæ¯
        document.getElementById('user-input').addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });

        // è¾“å…¥æ¡†è‡ªåŠ¨è°ƒæ•´é«˜åº¦
        function autoResizeTextarea() {
            const textarea = document.getElementById('user-input');
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 200) + 'px';
        }

        // ç›‘å¬è¾“å…¥æ¡†è¾“å…¥äº‹ä»¶ï¼Œè‡ªåŠ¨è°ƒæ•´é«˜åº¦
        document.getElementById('user-input').addEventListener('input', autoResizeTextarea);

        // ç›‘å¬è¾“å…¥æ¡†èšç„¦äº‹ä»¶ï¼Œåˆå§‹è°ƒæ•´é«˜åº¦
        document.getElementById('user-input').addEventListener('focus', autoResizeTextarea);

        // ç›‘å¬è¾“å…¥æ¡†ç²˜è´´äº‹ä»¶ï¼Œè‡ªåŠ¨è°ƒæ•´é«˜åº¦
        document.getElementById('user-input').addEventListener('paste', function() {
            setTimeout(autoResizeTextarea, 10);
        });
        
        // æ»šåŠ¨åˆ°åº•éƒ¨çš„å‡½æ•° - ä¿®å¤ç‰ˆæœ¬
        function scrollToBottom() {
            const chatContainer = document.querySelector('.chat-container');
            const chatHistory = document.getElementById('chat-history');
            
            if (chatContainer && chatHistory) {
                console.log('æ»šåŠ¨åˆ°åº•éƒ¨:', {
                    containerHeight: chatContainer.clientHeight,
                    containerScrollHeight: chatContainer.scrollHeight,
                    containerScrollTop: chatContainer.scrollTop,
                    historyHeight: chatHistory.clientHeight,
                    historyScrollHeight: chatHistory.scrollHeight
                });
                
                // æ–¹æ³•1: ç›´æ¥æ»šåŠ¨åˆ°æœ€åº•éƒ¨
                const scrollToEnd = () => {
                    chatContainer.scrollTop = chatContainer.scrollHeight;
                };
                
                // æ–¹æ³•2: ä½¿ç”¨scrollIntoViewç¡®ä¿æœ€åä¸€ä¸ªå…ƒç´ å¯è§
                const scrollToLastElement = () => {
                    const lastMessage = chatHistory.lastElementChild;
                    if (lastMessage) {
                        lastMessage.scrollIntoView({ behavior: 'smooth', block: 'end' });
                    }
                };
                
                // æ–¹æ³•3: å¼ºåˆ¶æ»šåŠ¨åˆ°æœ€å¤§å¯èƒ½ä½ç½®
                const forceScrollToBottom = () => {
                    const maxScrollTop = chatContainer.scrollHeight - chatContainer.clientHeight;
                    if (maxScrollTop > 0) {
                        chatContainer.scrollTop = maxScrollTop + 100; // åŠ ä¸€ç‚¹é¢å¤–ç©ºé—´
                    }
                };
                
                // ç«‹å³æ‰§è¡Œæ‰€æœ‰æ–¹æ³•
                scrollToEnd();
                scrollToLastElement();
                forceScrollToBottom();
                
                // ä½¿ç”¨requestAnimationFrameç¡®ä¿DOMæ›´æ–°åæ‰§è¡Œ
                requestAnimationFrame(() => {
                    scrollToEnd();
                    scrollToLastElement();
                    forceScrollToBottom();
                });
                
                // å¤šä¸ªå»¶è¿Ÿç¡®ä¿æ»šåŠ¨
                const delays = [0, 10, 50, 100, 200, 300, 500, 1000, 2000];
                delays.forEach(delay => {
                    setTimeout(() => {
                        scrollToEnd();
                        scrollToLastElement();
                        forceScrollToBottom();
                    }, delay);
                });
                
                // æ£€æŸ¥æ˜¯å¦çœŸçš„æ»šåŠ¨åˆ°åº•éƒ¨ï¼Œå¦‚æœæ²¡æœ‰åˆ™å¼ºåˆ¶å¤„ç†
                setTimeout(() => {
                    const currentScroll = chatContainer.scrollTop;
                    const maxScroll = chatContainer.scrollHeight - chatContainer.clientHeight;
                    
                    if (Math.abs(currentScroll - maxScroll) > 5) {
                        console.log('æ£€æµ‹åˆ°æ»šåŠ¨æœªåˆ°åº•éƒ¨ï¼Œå¼ºåˆ¶æ‰§è¡Œæ»šåŠ¨');
                        // å…ˆæ»šåŠ¨åˆ°é¡¶éƒ¨ï¼Œå†åˆ°åº•éƒ¨ï¼Œè§¦å‘é‡æ–°è®¡ç®—
                        chatContainer.scrollTop = 0;
                        setTimeout(() => {
                            chatContainer.scrollTop = chatContainer.scrollHeight;
                        }, 10);
                    }
                }, 100);
            }
        }
        
        // ç›‘å¬èŠå¤©å†å²å®¹å™¨çš„å˜åŒ–ï¼Œç¡®ä¿ä¸€ç›´ä¿æŒåœ¨æœ€åº•éƒ¨ - ä¿®å¤ç‰ˆæœ¬
        function setupAutoScroll() {
            const chatHistory = document.getElementById('chat-history');
            const chatContainer = document.querySelector('.chat-container');
            
            if (chatHistory && chatContainer) {
                console.log('è®¾ç½®è‡ªåŠ¨æ»šåŠ¨ç›‘æ§...');
                
                // ä½¿ç”¨MutationObserverç›‘å¬å†…å®¹å˜åŒ–ï¼Œç¡®ä¿æ–°æ¶ˆæ¯æ€»æ˜¯å¯è§
                const observer = new MutationObserver((mutations) => {
                    console.log('æ£€æµ‹åˆ°DOMå˜åŒ–ï¼Œæ‰§è¡Œæ»šåŠ¨');
                    scrollToBottom();
                    
                    // é¢å¤–æ£€æŸ¥æ–°æ·»åŠ çš„å›¾ç‰‡
                    mutations.forEach(mutation => {
                        if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {
                            mutation.addedNodes.forEach(node => {
                                if (node.nodeType === 1) { // å…ƒç´ èŠ‚ç‚¹
                                    const images = node.querySelectorAll('img');
                                    images.forEach(img => {
                                        if (!img.complete) {
                                            img.addEventListener('load', scrollToBottom);
                                            img.addEventListener('error', scrollToBottom);
                                        }
                                    });
                                }
                            });
                        }
                    });
                });
                
                // é…ç½®è§‚å¯Ÿé€‰é¡¹ï¼šç›‘å¬æ‰€æœ‰å¯èƒ½å½±å“æ»šåŠ¨ä½ç½®çš„å˜åŒ–
                observer.observe(chatHistory, {
                    childList: true,
                    subtree: true,
                    characterData: true,
                    attributes: true,
                    attributeFilter: ['style', 'class']
                });
                
                // åˆå§‹æ»šåŠ¨åˆ°åº•éƒ¨
                scrollToBottom();
                
                // æ·»åŠ é¢å¤–çš„æ»šåŠ¨ä¿éšœï¼šç›‘å¬çª—å£å¤§å°å˜åŒ–å’Œå†…å®¹åŠ è½½
                window.addEventListener('resize', () => {
                    console.log('çª—å£å¤§å°å˜åŒ–ï¼Œæ‰§è¡Œæ»šåŠ¨');
                    scrollToBottom();
                });
                
                // ç›‘å¬æ‰€æœ‰å›¾ç‰‡åŠ è½½å®Œæˆ
                chatHistory.addEventListener('load', (event) => {
                    if (event.target.tagName === 'IMG') {
                        console.log('å›¾ç‰‡åŠ è½½å®Œæˆï¼Œæ‰§è¡Œæ»šåŠ¨');
                        scrollToBottom();
                    }
                }, true);
                
                // ç›‘å¬å­—ä½“åŠ è½½å®Œæˆ
                document.fonts.ready.then(() => {
                    console.log('å­—ä½“åŠ è½½å®Œæˆï¼Œæ‰§è¡Œæ»šåŠ¨');
                    scrollToBottom();
                });
                
                // ç›‘å¬èŠå¤©å®¹å™¨çš„æ»šåŠ¨äº‹ä»¶ï¼Œæ™ºèƒ½åˆ¤æ–­ç”¨æˆ·æ˜¯å¦æ‰‹åŠ¨æ»šåŠ¨
                let lastScrollTop = 0;
                let userScrollTimeout;
                
                chatContainer.addEventListener('scroll', () => {
                    const currentScrollTop = chatContainer.scrollTop;
                    const maxScrollTop = chatContainer.scrollHeight - chatContainer.clientHeight;
                    
                    // å¦‚æœç”¨æˆ·æ»šåŠ¨åˆ°æ¥è¿‘åº•éƒ¨ï¼ˆ50pxå†…ï¼‰ï¼Œå…è®¸è‡ªåŠ¨æ»šåŠ¨
                    if (maxScrollTop - currentScrollTop <= 50) {
                        // ç”¨æˆ·å·²ç»æ¥è¿‘åº•éƒ¨ï¼Œå…è®¸è‡ªåŠ¨æ»šåŠ¨
                        clearTimeout(userScrollTimeout);
                    } else if (currentScrollTop < lastScrollTop) {
                        // ç”¨æˆ·å‘ä¸Šæ»šåŠ¨ï¼Œæš‚åœè‡ªåŠ¨æ»šåŠ¨
                        console.log('ç”¨æˆ·æ‰‹åŠ¨æ»šåŠ¨ï¼Œæš‚åœè‡ªåŠ¨æ»šåŠ¨');
                        clearTimeout(userScrollTimeout);
                        userScrollTimeout = setTimeout(() => {
                            console.log('ç”¨æˆ·åœæ­¢æ»šåŠ¨ï¼Œæ¢å¤è‡ªåŠ¨æ»šåŠ¨');
                        }, 2000);
                    }
                    
                    lastScrollTop = currentScrollTop;
                });
                
                // è®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨ï¼Œå®šæœŸæ£€æŸ¥æ˜¯å¦éœ€è¦æ»šåŠ¨
                const autoScrollInterval = setInterval(() => {
                    const currentScrollTop = chatContainer.scrollTop;
                    const maxScrollTop = chatContainer.scrollHeight - chatContainer.clientHeight;
                    
                    // å¦‚æœæ¥è¿‘åº•éƒ¨æˆ–ç”¨æˆ·é•¿æ—¶é—´æœªæ“ä½œï¼Œå…è®¸æ»šåŠ¨
                    if (maxScrollTop - currentScrollTop <= 50 || !userScrollTimeout) {
                        scrollToBottom();
                    }
                }, 1000);
                
                // æ¸…ç†å‡½æ•°
                window.addEventListener('beforeunload', () => {
                    clearInterval(autoScrollInterval);
                    observer.disconnect();
                });
                
            } else {
                console.error('chat-historyæˆ–chat-containerå…ƒç´ æœªæ‰¾åˆ°ï¼Œæ— æ³•è®¾ç½®è‡ªåŠ¨æ»šåŠ¨');
                
                // å¦‚æœå…ƒç´ æœªæ‰¾åˆ°ï¼Œå»¶è¿Ÿé‡è¯•
                setTimeout(setupAutoScroll, 500);
            }
        }
        
        function isMobileDevice() {
            return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || 
                   window.innerWidth <= 768;
        }
        
        // è®¾ç½®ç§»åŠ¨ç«¯é€‚é…
        function setupMobileAdaptation() {
            if (isMobileDevice()) {
                console.log('æ£€æµ‹åˆ°ç§»åŠ¨è®¾å¤‡ï¼Œæ­£åœ¨åº”ç”¨ç§»åŠ¨ç«¯é€‚é…');
                
                // åˆ›å»ºç§»åŠ¨ç«¯é¡¶éƒ¨å¯¼èˆªæ 
                const mobileNavbar = document.createElement('div');
                mobileNavbar.className = 'mobile-navbar';
                mobileNavbar.innerHTML = '<div style="text-align: center; font-size: 12px; font-weight: 600; color: #2d3748; padding: 6px 0; background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(20px); border-bottom: 1px solid rgba(0, 0, 0, 0.1);">WanQian7</div>';
                document.body.insertBefore(mobileNavbar, document.body.firstChild);
                
                // éšè—åŸå¯¼èˆªæ 
                const navbar = document.querySelector('.navbar');
                if (navbar) {
                    navbar.style.display = 'none';
                    console.log('å¯¼èˆªæ å·²éšè—');
                }
                
                // è°ƒæ•´èŠå¤©å®¹å™¨ä½ç½®å’Œå¤§å° - ä½¿ç”¨è§†å£å•ä½å®Œç¾æ’‘æ»¡
                const chatContainer = document.querySelector('.chat-container');
                if (chatContainer) {
                    chatContainer.style.top = '25px';
                    chatContainer.style.left = '8px';
        chatContainer.style.right = '8px';
                    chatContainer.style.bottom = '190px'; // å¢åŠ åº•éƒ¨é—´è·ï¼Œç¡®ä¿ä¸é®æŒ¡
                    chatContainer.style.padding = '0px';
                    chatContainer.style.borderRadius = '0px';
                    chatContainer.style.margin = '0px';
                    console.log('èŠå¤©å®¹å™¨å·²è°ƒæ•´');
                }
                
                // è°ƒæ•´è¾“å…¥å®¹å™¨ - ä½¿ç”¨è§†å£å•ä½å®Œç¾æ’‘æ»¡
                const inputContainer = document.querySelector('.input-container');
                if (inputContainer) {
                    inputContainer.style.left = '8px';
                    inputContainer.style.right = '8px';
                    inputContainer.style.bottom = '0px';
                    inputContainer.style.padding = '10px';
                    inputContainer.style.borderRadius = '8px 8px 0px 0px';
                    inputContainer.style.width = 'auto';
                    inputContainer.style.boxSizing = 'border-box';
                    inputContainer.style.position = 'fixed';
                    console.log('è¾“å…¥å®¹å™¨å·²è°ƒæ•´');
                }
                
                // è°ƒæ•´æ¶ˆæ¯æœ€å¤§å®½åº¦
                const messages = document.querySelectorAll('.message');
                messages.forEach(msg => {
                    msg.style.maxWidth = '92%';
                    msg.style.marginBottom = '10px';
                    msg.style.padding = '8px 12px';
                    msg.style.fontSize = '14px';
                });
                
                // è°ƒæ•´æ¨¡å‹é€‰æ‹©å™¨ - å®Œå…¨ç§»åŠ¨ç«¯ä¼˜åŒ–
                const modelSelector = document.querySelector('.model-selector');
                if (modelSelector) {
                    modelSelector.style.marginBottom = '10px';
                    modelSelector.style.width = '100%';
                    
                    const select = modelSelector.querySelector('select');
                    if (select) {
                        select.style.minWidth = '100%';
                        select.style.maxWidth = '100%';
                        select.style.padding = '8px 12px';
                        select.style.fontSize = '13px';
                        select.style.borderRadius = '8px';
                        select.style.boxSizing = 'border-box';
                    }
                    
                    const label = modelSelector.querySelector('label');
                    if (label) {
                        label.style.fontSize = '10px';
                        label.style.padding = '2px 6px';
                    }
                }
                
                // è°ƒæ•´è¾“å…¥åŒºåŸŸå¸ƒå±€ - å‚ç›´æ’åˆ—
                const inputArea = document.querySelector('.input-area');
                if (inputArea) {
                    inputArea.style.flexDirection = 'column';
                    inputArea.style.gap = '10px';
                    inputArea.style.width = '100%';
                }
                
                // è°ƒæ•´è¾“å…¥æ¡† - å®Œå…¨ç§»åŠ¨ç«¯ä¼˜åŒ–
                const textarea = document.getElementById('user-input');
                if (textarea) {
                    textarea.style.height = '60px';
                    textarea.style.width = 'calc(100% - 20px)';
                    textarea.style.padding = '10px';
                    textarea.style.fontSize = '13px';
                    textarea.style.borderRadius = '8px';
                    textarea.style.minHeight = '60px';
                    textarea.style.maxHeight = '100px';
                    textarea.style.boxSizing = 'border-box';
                }
                
                // è°ƒæ•´å‘é€æŒ‰é’® - ç§»åŠ¨ç«¯ä¼˜åŒ–
                const sendButton = document.querySelector('.input-area button');
                if (sendButton) {
                    sendButton.style.width = '100%';
                    sendButton.style.padding = '10px';
                    sendButton.style.fontSize = '14px';
                    sendButton.style.borderRadius = '8px';
                    sendButton.style.marginTop = '5px';
                    sendButton.style.boxSizing = 'border-box';
                }
                
                console.log('ç§»åŠ¨ç«¯é€‚é…å®Œæˆ');
            } else {
                console.log('å½“å‰è®¾å¤‡ä¸æ˜¯ç§»åŠ¨è®¾å¤‡');
            }
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåè®¾ç½®è‡ªåŠ¨æ»šåŠ¨å’Œç§»åŠ¨ç«¯é€‚é… - ä¿®å¤ç‰ˆæœ¬
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOMåŠ è½½å®Œæˆï¼Œå¼€å§‹è®¾ç½®è‡ªåŠ¨æ»šåŠ¨...');
            
            // ç¡®ä¿å…ƒç´ å­˜åœ¨åå†è®¾ç½®è‡ªåŠ¨æ»šåŠ¨
            const checkElements = () => {
                const chatHistory = document.getElementById('chat-history');
                const chatContainer = document.querySelector('.chat-container');
                
                if (chatHistory && chatContainer) {
                    console.log('æ‰¾åˆ°èŠå¤©å…ƒç´ ï¼Œè®¾ç½®è‡ªåŠ¨æ»šåŠ¨');
                    setupAutoScroll();
                    setupMobileAdaptation();
                    scrollToBottom();
                } else {
                    console.log('èŠå¤©å…ƒç´ æœªæ‰¾åˆ°ï¼Œå»¶è¿Ÿé‡è¯•...');
                    setTimeout(checkElements, 200);
                }
            };
            
            // ç«‹å³æ£€æŸ¥
            checkElements();
            
            // é¢å¤–å»¶è¿Ÿå†æ¬¡ç¡®ä¿
            setTimeout(() => {
                scrollToBottom();
            }, 500);
            
            setTimeout(() => {
                scrollToBottom();
            }, 1000);
        });
        
        // é˜²æ­¢F12æŸ¥çœ‹æºä»£ç 
        document.addEventListener('keydown', function(e) {
            // ç¦ç”¨F12é”®
            if (e.key === 'F12' || e.keyCode === 123) {
                e.preventDefault();
                return false;
            }
            // ç¦ç”¨Ctrl+Shift+I (å¼€å‘è€…å·¥å…·)
            if (e.ctrlKey && e.shiftKey && e.key === 'I') {
                e.preventDefault();
                return false;
            }
            // ç¦ç”¨Ctrl+Shift+J (æ§åˆ¶å°)
            if (e.ctrlKey && e.shiftKey && e.key === 'J') {
                e.preventDefault();
                return false;
            }
            // ç¦ç”¨Ctrl+U (æŸ¥çœ‹æºä»£ç )
            if (e.ctrlKey && e.key === 'U') {
                e.preventDefault();
                return false;
            }
        });

        // ç¦ç”¨å³é”®èœå•
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
            return false;
        });

        // ç¦ç”¨æ–‡æœ¬é€‰æ‹©å’Œå¤åˆ¶
        document.addEventListener('selectstart', function(e) {
            e.preventDefault();
            return false;
        });

        // ç¦ç”¨æ‹–æ‹½
        document.addEventListener('dragstart', function(e) {
            e.preventDefault();
            return false;
        });

        // å¤åˆ¶ä»£ç åŠŸèƒ½
        function copyCode(button) {
            const codeBlock = button.previousElementSibling;
            const codeText = codeBlock.textContent;
            
            navigator.clipboard.writeText(codeText).then(() => {
                const originalText = button.textContent;
                button.textContent = 'å·²å¤åˆ¶!';
                
                setTimeout(() => {
                    button.textContent = originalText;
                }, 2000);
            }).catch(err => {
                console.error('å¤åˆ¶å¤±è´¥:', err);
                button.textContent = 'å¤åˆ¶å¤±è´¥';
            });
        }
        

    </script>
</body>
</html>